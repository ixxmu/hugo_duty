---
title: "【视频课程13】跟着Nature Com学作图 -- 渐变柱状图"
date: 2023-05-24T02:23:05Z
draft: ["false"]
tags: [
  "fetched",
  "生信师兄"
]
categories: ["Duty"]
---
【视频课程13】跟着Nature Com学作图 -- 渐变柱状图 by 生信师兄
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><figure data-tool="mdnice编辑器"><img data-ratio="0.4351851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjw7h7WJwkxp3EyrcdakC9cN38JUhMo0j3AaWic24PtaOopyicwx80myPsw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjw7h7WJwkxp3EyrcdakC9cN38JUhMo0j3AaWic24PtaOopyicwx80myPsw/640?wx_fmt=png"><figcaption><span></span>封面</figcaption></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>「生信常用分析图形系列」</strong>和<strong>「跟着高分SCI绘图系列」</strong>从2021年10月份至今已经一年半的时间啦！在此期间师兄不仅总结更新的很多生信常用的图形绘制代码，也带着大家从各大顶级期刊中的Figuer入手，从仿照别人的作图风格到最后实现自己游刃有余的套用在自己的分析数据上！可以说是绝对的高质量，因此也受到了广大粉丝的青睐。与此同时，师兄的<strong>「「R语言生信绘图群」」</strong>，也从<strong>「最开始的0人逐渐到了现在的4群即将满员（即将达到2000名学员）」</strong>。</p><p>但是只提供示例数据和代码，对于很多小白来说还是很难上手的，<strong>「如何准确地理解每个图的意义，精准地掌握师兄的每一行代码，并且更加灵活地应用于自己的数据中？」</strong> 这才是众多小白更迫切需要的内容！于是，师兄准备开始录制<strong>「高分SCI图表复现系列配套的视频教程」</strong>，以帮助大家更好地将师兄的代码发挥出最大的价值！</p><p>本系列课程特价仅售<strong>「￥399元（<span>原价￥499元</span>）」</strong>，此外，购买本课程的小伙伴还可同时获得<strong>「「生信常用分析图形系列」」</strong>和<strong>「「跟着高分SCI绘图系列」」</strong>两个系列的所有代码和示例数据（包含既往已经更新，和后续即将更新的部分）。大家<strong>「购买后请务必扫码加师兄微信」</strong>，师兄会及时拉群哦！</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>课程大纲</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="1.6046296296296296" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjwJiaQco8hicJoRB8k8F5EdsfIbrY210D718p8Q2jic6MthGKoZUSPvWLmQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjwJiaQco8hicJoRB8k8F5EdsfIbrY210D718p8Q2jic6MthGKoZUSPvWLmQ/640?wx_fmt=png"><figcaption><span></span>课程大纲</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>长按识别二维码购课（拼团有优惠哦！）</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="1.5995670995670996" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjwUiagich3IFMfE8B0Vg4cDMicaGFiaqmic2lbwFicvOtwUlFS0DXFLKmicp8Vg/640?wx_fmt=png" data-type="png" data-w="924" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjwUiagich3IFMfE8B0Vg4cDMicaGFiaqmic2lbwFicvOtwUlFS0DXFLKmicp8Vg/640?wx_fmt=png"><figcaption><span></span>长按识别二维码购课</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>付费群学员福利：</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>已经加入生信师兄【R语言生信绘图群1-4群】的小伙伴可<strong>「直接优惠￥179元，扫码添加师兄微信后领取专属优惠券！」</strong></p><h5><span></span><strong>「声明」</strong><span></span></h5><ul><li><section><strong>「本课程内容自动包含R语言绘图群所有内容」</strong>，购买本课程的小伙伴无需再额外购买R语言绘图群内容，也无需关注R语言绘图群价格变动，示例数据和代码将在文章更新后同步更新！</section></li></ul><span>❞</span></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.9922630560928434" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjwJARfoqHsvfgWw6tZs3ic1V0psSvoqX2JPicEZYwEEvCElb7mwkRCmicgw/640?wx_fmt=png" data-type="png" data-w="517" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjwJARfoqHsvfgWw6tZs3ic1V0psSvoqX2JPicEZYwEEvCElb7mwkRCmicgw/640?wx_fmt=png"><figcaption><span></span>师兄微信</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>本期图形</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.6138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjwuOlKYLRneFWWY6xKCu66zjhm5NWnqprcvFCg0BoKkTFyvXuPBQO8GA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjwuOlKYLRneFWWY6xKCu66zjhm5NWnqprcvFCg0BoKkTFyvXuPBQO8GA/640?wx_fmt=png"><figcaption><span></span>参考文献</figcaption></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本期分享的是Nature Communication上面一篇文章中的一个<strong>「渐变柱状图」</strong>！</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">话不多说，直接上图！</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>读图</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="1.038888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjwQtiaxJkCfW0bNQJQqibicHSYjiau4EcEc6dhgf0vod16FR6uZ3x7A2ib6Aw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjwQtiaxJkCfW0bNQJQqibicHSYjiau4EcEc6dhgf0vod16FR6uZ3x7A2ib6Aw/640?wx_fmt=png"><figcaption><span></span>原图</figcaption></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>这张图理解起来没什么复杂的，但是有些细节还是值得大家好好学习的，例如：</p><ul><li><section>图例位置的调整</section></li><li><section>主题的调整：网格线、边框颜色、坐标轴刻度、坐标轴字体等</section></li><li><section>注释添加</section></li></ul><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>效果展示</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="1.25" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjwlZWgDELRwOprvoxSmWjGhDkV8mOSwZg25zt1xZpFTZC0InChYBqVaQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjwlZWgDELRwOprvoxSmWjGhDkV8mOSwZg25zt1xZpFTZC0InChYBqVaQ/640?wx_fmt=png"><figcaption><span></span>复现效果</figcaption></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本次复现完美的解决了上述所有难点，且均通过R语言完成！大家可以放心食用！</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据构建</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># 加载R包：</span><br><span>library</span>(ggplot2)<br><br><span># 构建示例数据：</span><br>data &lt;- data.frame(<br>  Gene = paste0(<span>"Cancer"</span>, <span>1</span>:<span>21</span>),<br>  Log2FC = c(runif(<span>15</span>, -<span>0.5</span>,<span>0</span>), runif(<span>6</span>, <span>0</span>, <span>0.5</span>)),<br>  <span>"Log10qvalue"</span> = c(runif(<span>6</span>, <span>1</span>, <span>3</span>),runif(<span>15</span>, <span>0</span>, <span>1</span>)))<br><br><span># 查看数据：</span><br>head(data)<br><span>#      Gene      Log2FC Log10qvalue</span><br><span># 1 Cancer1 -0.18511148    2.634901</span><br><span># 2 Cancer2 -0.13808342    1.939038</span><br><span># 3 Cancer3 -0.30934002    2.632905</span><br><span># 4 Cancer4 -0.04036049    1.911711</span><br><span># 5 Cancer5 -0.04722910    1.024237</span><br><span># 6 Cancer6 -0.18350572    1.759855</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘图代码</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>ggplot(data)+<br>  <span># 竖线：</span><br>  geom_hline(yintercept = c(-log2(<span>1.2</span>), -log2(<span>1.5</span>)), <br>             color = <span>"grey"</span>, linetype = <span>"dotted"</span>)+<br>  <span># 柱状图</span><br>  geom_col(aes(x = reorder(Gene, Log2FC), y = Log2FC, fill = Log10qvalue),<br>           color = <span>"grey"</span>)+<br>  <span># 黑线：</span><br>  geom_hline(yintercept = <span>0</span>, color = <span>"black"</span>)+<br>  <span># 渐变颜色填充：</span><br>  scale_fill_gradientn(name=<span>"-Log10_\nq-value"</span>, <span># 修改图例标题</span><br>                       colours = c(<span>"#f6fafd"</span>, <span>"#c8dfef"</span>, <span>"#6fa6d1"</span>, <span>"#2c49a2"</span>),<br>                       breaks = <span>0</span>:<span>3</span>,<br>                       labels = paste0(<span>0</span>:<span>3</span>, <span>".0"</span>))+<br>  <br>  <span># 坐标轴标题：</span><br>  xlab(<span>""</span>)+<br>  ylab(<span>"Log2FC(9p21-Loss vs .9p21-WT)"</span>)+<br>  <span># 增大边缘柱形与边框的距离</span><br>  scale_x_discrete(expand = c(<span>0.05</span>, <span>0.05</span>))+<br>  <span># 注释：</span><br>  annotate(geom = <span>"text"</span>, y = -<span>0.5</span>, x = <span>21</span>, label = <span>"FC&lt;-1.2"</span>)+<br>  <span># 标题：</span><br>  ggtitle(<span>"TCR shannon entroy"</span>)+<br>  <span># 坐标轴翻转：</span><br>  coord_flip()+<br>  <span># 主题：</span><br>  theme_light()+<br>  theme(panel.grid = element_blank(),  <span># 去掉网格线</span><br>        plot.title = element_text(hjust = <span>0.5</span>, face = <span>"bold"</span>), <span># 标题居中、字体</span><br>        axis.ticks.y = element_blank(), <span># 去掉y轴刻度线</span><br>        axis.title.x = element_text(size = <span>10</span>),  <span># x轴标题大小</span><br>        axis.text.y = element_text(size = <span>10</span>),  <span># y轴刻度大小</span><br>        panel.border = element_rect(color = <span>"black"</span>),<br>        legend.position=c(<span>0.9</span>,<span>0.1</span>), legend.justification=c(<span>1</span>,<span>0</span>))  <span># 图例位置</span><br><br><span># 保存</span><br>ggsave(<span>"barplot.pdf"</span>, height = <span>5</span>, width = <span>4</span>)  <br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>结果展示</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="1.25" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjwlZWgDELRwOprvoxSmWjGhDkV8mOSwZg25zt1xZpFTZC0InChYBqVaQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6TY5YZF1uFxjp8UvpVjOjwlZWgDELRwOprvoxSmWjGhDkV8mOSwZg25zt1xZpFTZC0InChYBqVaQ/640?wx_fmt=png"><figcaption><span></span>复现效果</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>本期视频</span><span></span></h3><p><mp-pay-preview-filter data-offset="26"></mp-pay-preview-filter></p></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/jY73in_li7KfKjP6P_Dl1w",target="_blank" rel="noopener noreferrer">原文链接</a>
