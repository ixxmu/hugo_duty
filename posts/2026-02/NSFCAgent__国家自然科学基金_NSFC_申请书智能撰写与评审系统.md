---
title: "NSFCAgent——国家自然科学基金（NSFC）申请书智能撰写与评审系统"
date: 2026-02-11T23:02:35Z
draft: ["false"]
tags: [
  "fetched",
  "牛学汇"
]
categories: ["Duty"]
---
NSFCAgent——国家自然科学基金（NSFC）申请书智能撰写与评审系统 by 牛学汇
------
<div><p data-pm-slice="0 0 []"><font face="宋体"><span leaf="">传统基金申请写作中，研究者往往需要反复查阅文献、梳理研究内容、打磨技术路线，再逐字逐句撰写申请书。一个优秀的项目可能因撰写过程中的疏漏而错失良机。</span></font><font face="宋体"><span leaf="">为此，我们基于<span textstyle="">多</span></span></font><span leaf=""><span textstyle="">Agent协作架构</span>开发了</span><span leaf=""><span textstyle="">NSFCAgent</span></span><font face="宋体"><span leaf="">——<span textstyle="">国家自然科学基金（NSFC）申请书智能撰写与评审系统</span>。跳过了<span textstyle="">文献整理</span>、<span textstyle="">内容框架搭建</span>、<span textstyle="">格式规范调整</span>等繁琐步骤，自动将研究想法转化为符合NSFC标准的申请书，直接给出可使用的文档。</span></font></p><p><font face="宋体"><span leaf="">无需用户进行手动格式调整或复杂配置，系统<span textstyle="">可视化交互响应操作</span>。不仅能<span textstyle="">在预设的标准化环境中精准生成国自然格式文档</span>，高度复现专业写作规范，还能<span textstyle="">灵活处理各类学科领域的申请需求</span>。</span></font><font face="宋体"><span leaf="">在<span textstyle="">内联修订确认</span>、</span></font><span leaf=""><span textstyle="">arXiv智能检索</span>、<span textstyle="">章节权重分配</span>等多个核心功能模块中经过测试，均实现了与人工撰写质量的高度一致，充分验证了其在复杂场景下的稳定实用性。</span></p><section nodeleaf=""><img data-aistatus="1" data-ratio="0.575925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/jjKyFnng2eGSjYxjJ9ibUvWwzdwOCc2ibNaK5XGC6T11WUC8P9ndNicRrVVx3C1cT6PJYeCRprrjzbDr5Xv4yM3hwq8jkpY73CicK6Jia0ZqbbqA/640?wx_fmt=png&amp;from=appmsg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/jjKyFnng2eGSjYxjJ9ibUvWwzdwOCc2ibNaK5XGC6T11WUC8P9ndNicRrVVx3C1cT6PJYeCRprrjzbDr5Xv4yM3hwq8jkpY73CicK6Jia0ZqbbqA/640?wx_fmt=png&amp;from=appmsg"></section><section data-class="_mbEditor" data-id="2169746"><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><section data-class="_mbEditor" data-id="2169746"><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><span leaf=""><br></span></section><section data-mid=""><span leaf=""><br></span></section></section><section data-mid=""><p data-mid=""><span leaf="">核心架构</span></p></section></section></section></section></section></section><p><span><span leaf=""><br></span></span></p><p><span><span leaf="">NSFCAgent的核心架构采用</span></span><b><span leaf=""><span textstyle="">4+1 Agent协作模式</span></span></b><span><font face="宋体"><span leaf="">，以</span></font><span leaf="">LangGraph状态机为协调核心，将基金申请书撰写过程封装为多角色协同的智能体系统。每位Agent承担明确职责，通过Orchestrator协调器实现<span textstyle="">撰写</span>→<span textstyle="">评审</span>→<span textstyle="">修订确认</span>的全流程自动化。</span></span><span><span leaf="">通过角色分工，将申请书所需的文献检索、内容撰写、专业评审、格式优化等核心任务，统一编码为<span textstyle="">可执行</span>、<span textstyle="">可协同</span>、<span textstyle="">可追溯</span>的标准化流程，让原本分散的撰写工作形成一个清晰、规整的协作网络。</span></span></p></section></section></section></section></section></section><ul><li><p><b><span leaf=""><span textstyle="">Writer Agent（首席研究员 PI）</span></span></b><font face="宋体"><span leaf="">：<span textstyle="">主持研讨、整合专家意见、生成最终申请书内容。</span>作为团队核心，</span></font><span leaf="">Writer Agent承担着领导职责，带领团队攻克基金申请书撰写中的重要问题，基于成员意见对项目方向做出关键决策，同时负责管理撰写进度与资源，最终实现申请质量的科学化与专业化。</span></p></li><li><p><b><span leaf=""><span textstyle="">Searcher Agent（文献专员 LR</span>）</span></b><font face="宋体"><span leaf="">：<span textstyle="">自动提取英文关键词、检索</span></span></font><span leaf=""><span textstyle="">arXiv最新文献、提供研究背景支持。</span>凭借专业优势，为立项依据部分的撰写提供权威文献支撑，在研究前沿动态、与相关研究的对比分析等关键问题上，给出精准的专业建议。</span></p></li><li><p><b><span leaf=""><span textstyle="">Reviewer Agent（科学评论家 SC）</span></span></b><font face="宋体"><span leaf="">：<span textstyle="">自动评审初稿、生成结构化修订建议、进行评分与逻辑审查。</span>为全过程提供关键性反馈与质控，确保申请书的内容严谨、详尽、可行且具备科学合理性，从立项依据的创新性到研究方案的可行性进行全面审查。</span></font></p></li><li><p><b><span leaf=""><span textstyle="">Designer Agent（基金策略师 FS）</span></span></b><font face="宋体"><span leaf="">：<span textstyle="">重构创新性不足内容、优化章节结构、增强学术表达。</span>聚焦技术表达优化，主导构建并优化申请书的技术路线部分，一方面实现研究内容的逻辑性提升，另一方面优化学术表达以精准传递研究的创新价值与科学意义。</span></font></p></li><li><p><b><span leaf=""><span textstyle="">Orchestrator（协调器）</span></span></b><font face="宋体"><span leaf="">：<span textstyle="">通过</span></span></font><span leaf=""><span textstyle="">LangGraph状态机驱动，管理整个撰写流程的状态流转与任务调度。</span>作为系统的中枢神经，协调器确保各Agent之间的信息传递顺畅，保证撰写、评审、修订三个阶段的无缝衔接。</span></p><p><span leaf=""><img data-aistatus="1" data-imgfileid="100000501" data-ratio="0.7862407862407862" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/jjKyFnng2eHB7Q8ZQS8vOZx0ZS144PRhYAUFvnE6uAIQiaOtomWJA2ic4Y1WtnZ1F4opMOjesBwGF8hgsia5oamtbBwqWUwXJBENreVTFUAOu4/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1221" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/jjKyFnng2eHB7Q8ZQS8vOZx0ZS144PRhYAUFvnE6uAIQiaOtomWJA2ic4Y1WtnZ1F4opMOjesBwGF8hgsia5oamtbBwqWUwXJBENreVTFUAOu4/640?wx_fmt=png&amp;from=appmsg"> </span></p></li></ul><section data-class="_mbEditor" data-id="2169746"><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><span leaf=""><br></span></section><section data-mid=""><span leaf=""><br></span></section></section><section data-mid=""><p data-mid=""><span leaf="">实现流程</span></p></section></section></section></section></section><font face="宋体"><span leaf="">申请书智能生成过程由协调器驱动四类专家</span></font><span leaf="">Agent协同完成，全程注重专业性与可复现性：</span></section><ul><li><p><b><font face="宋体"><span leaf=""><span textstyle="">文献检索阶段</span></span></font></b><font face="宋体"><span leaf="">：</span></font><span leaf=""><span textstyle="">Searcher Agent</span>从中文研究主题<span textstyle="">自动提取5个英文关键词</span>，<span textstyle="">检索arXiv最新15篇相关论文</span>，为申请书的立项依据部分提供权威文献支撑。系统内置了arXivAPI集成与XML解析功能，支持本地缓存以提高检索效率，确保文献来源的准确性与时效性。</span><span><p></p></span></p></li><li><p><b><font face="宋体"><span leaf=""><span textstyle="">分层讨论阶段</span></span></font></b><font face="宋体"><span leaf="">：</span></font><span leaf=""><span textstyle="">Writer Agent</span>作为首席研究员<span textstyle="">主持多轮专家讨论</span>，默认1轮讨论阶段，4位专家分别发言提供框架性建议，每个Agent发言控制在300字内，确保建议的精炼与聚焦。最后由WriterAgent<span textstyle="">统筹生成完整的8章节申请书内容</span>，生成控制在8000 tokens范围内，并设置300秒超时保护机制。</span><span><p></p></span></p></li><li><p><b><font face="宋体"><span leaf=""><span textstyle="">自动评审阶段</span></span></font></b><font face="宋体"><span leaf="">：生成</span></font><span leaf="">DOCX文档后自动触发<span textstyle="">Reviewer Agent</span>评审模式，科学评论家对申请书进行<span textstyle="">全面审查</span>，<span textstyle="">生成3-5条结构化修订建议</span>，<span textstyle="">包括内容逻辑、学术表达、创新性等方面的专业点评</span>。评审结果会以JSON格式保存，包含评分、修改建议、问题定位等详细信息。</span><span><p></p></span></p></li><li><p><b><font face="宋体"><span leaf=""><span textstyle="">内联修订阶段</span></span></font></b><font face="宋体"><span leaf="">：系统进入修订确认窗口，用户<span textstyle="">可逐条审查每条建议</span>。左侧显示修订列表，中间展示差异对比（红色删除、绿色新增），右侧实时预览文档最终效果。支持接受、跳过、撤回等操作，修订记录完整可追溯。</span></font></p><p><font face="宋体"><span leaf="">整个生成过程中，每个章节都保留清晰的生成来源与修改痕迹，确保内容可追踪、可追溯；同时优先通过已审校的模板完成格式处理，减少手动调整带来的格式错误，进一步保障了申请书的专业性与规范性。</span></font><span><span leaf=""> </span></span></p></li></ul><section nodeleaf=""><img data-aistatus="1" data-imgfileid="100000508" data-ratio="0.5748909355307804" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/jjKyFnng2eFzyBblaeG3vcHVAGpwy2RUbdib4UIG5NrtE7ujpIXSr1mb6D87ssniccqalicfjBibIyWvQXm0QZxZ0DqaAFUFEibRicyfEEbtLqY8U/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="2063" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/jjKyFnng2eFzyBblaeG3vcHVAGpwy2RUbdib4UIG5NrtE7ujpIXSr1mb6D87ssniccqalicfjBibIyWvQXm0QZxZ0DqaAFUFEibRicyfEEbtLqY8U/640?wx_fmt=png&amp;from=appmsg"></section><section data-class="_mbEditor" data-id="2169746"><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><span leaf=""><br></span></section></section><section data-mid=""><p data-mid=""><span leaf="">重塑新范式</span></p></section></section></section></section></section><span><span leaf="">NSFCAgent展示了一种全新的基金申请撰写范式。AI的定位发生了根本性转变，不再是<span textstyle="">被动调用的"文字工具"</span>，而是<span textstyle="">主动参与的"科研合作者"</span>。在相关申请写作工作中，所有高层内容决策和结构选择均由AIAgent团队协作完成，研究者则聚焦于高层指导与专业把关。</span></span><font face="宋体"><span leaf="">凭借高效的协作能力，</span></font><span leaf="">AI Agent团队仅用很短时间就能完成从文献调研到申请书撰写的整套复杂流程。更重要的是，<span textstyle="">通过设置不同领域的AI专家，能从各自专业背景出发，为基金申请书的撰写提供多角度见解，最终形成更全面、更具深度的申请材料</span>。</span></section><p><span><span leaf="">Writer Agent从整体上<span textstyle="">把控申请书的逻辑框架与创新性表达</span>；Searcher Agent确保立项依据部分的<span textstyle="">文献支撑充分且前沿</span>；ReviewerAgent从评审专家的视角提前<span textstyle="">发现问题并提供改进建议</span>；Designer Agent专门负责<span textstyle="">提升申请书的技术表达与学术规范性</span>。这种全新范式不仅打破了传统基金申请写作中的技术壁垒，更极大提升了申请书撰写的效率与质量，为科研创新成果的转化开辟了新的可能。</span></span></p><section data-class="_mbEditor" data-id="2169746"><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><span leaf=""><br></span></section><section data-mid=""><span leaf=""><br></span></section></section><section data-mid=""><p data-mid=""><span leaf="">使用说明</span></p></section></section></section></section></section><b><font face="MS Gothic"><span leaf=""><span textstyle="">环境配置</span>：</span></font></b><font face="宋体"><span leaf="">首次使用需先<span textstyle="">完成</span></span></font><span leaf=""><span textstyle="">API配置</span>，系统支持对接<span textstyle="">DeepSeek</span>、<span textstyle="">Kimi</span>、<span textstyle="">豆包</span>、<span textstyle="">通义千问</span>等多个主流AI模型。在".env"文件中填写对应的API密钥，系统内置了API过载保护机制，包括指数退避重试、模型降级链、分时延迟等三级保护措施，确保稳定运行。</span></section><section nodeleaf=""><img data-aistatus="1" data-imgfileid="100000498" data-ratio="0.96875" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/jjKyFnng2eGNk9K6FFRYj7toSgO5bVYjZaJib3McXQBMPppGrym0VBpENgo7qsgJcpJib49zibkG8jibga9gUPQYvVEsmRZ6SVOdBow2143YgIw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="576" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/jjKyFnng2eGNk9K6FFRYj7toSgO5bVYjZaJib3McXQBMPppGrym0VBpENgo7qsgJcpJib49zibkG8jibga9gUPQYvVEsmRZ6SVOdBow2143YgIw/640?wx_fmt=png&amp;from=appmsg"></section><h3><b><font face="MS Gothic"><span leaf=""><span textstyle="">模板准备:</span></span></font></b><font face="宋体"><span leaf="">将</span></font><span leaf="">NSFC<span textstyle="">空白模板</span>（面上项目-正文-修改版.docx）放入"data/templates/"目录，系统会自动识别模板结构，包括摘要表格、复杂表格样式、章节标题格式等，严格遵循国自然格式规范（宋体小四正文、黑体三号标题、1.5倍行距）。</span></h3><p><font face="宋体"><span leaf="">系统内置了智能模板处理引擎，能够正确处理</span></font><span leaf="">5行2列的标准摘要表格、保留复杂表格的合并单元格和边框样式、基于TF-IDF相似度匹配AI输出与模板槽位，确保生成内容的精准定位。</span><span><p></p></span></p><h3><b><font face="MS Gothic"><span leaf=""><span textstyle="">撰写新申请书:</span></span></font></b><font face="宋体"><span leaf="">在桌面应用界面<span textstyle="">选择基金类型</span>（面上</span></font><span leaf="">/青年/重点），勾选"<span textstyle="">使用arXiv检索</span>"选项，<span textstyle="">输入研究主题</span>（如：肝细胞癌免疫治疗耐药机制），设置讨论轮次（建议1-2轮），点击"<span textstyle="">开始会议</span>"后系统自动启动4+1专家协同撰写流程，等待生成完成后自动进入评审修订窗口。</span></h3><p><font face="宋体"><span leaf="">整个撰写过程大约需要</span></font><span leaf="">3-5分钟，系统会在界面实时显示各Agent的工作状态与进展。文献检索、专家讨论、文档生成、自动评审四个阶段依次进行，每个阶段都有明确的进度提示。</span><span><p></p></span></p><h3><b><font face="MS Gothic"><span leaf=""><span textstyle="">内联修订确认:</span></span></font></b><font face="宋体"><span leaf="">在修订窗口中，<span textstyle="">左侧面板显示所有修订建议</span>，<span textstyle="">中间区域展示红绿差异对比效果</span>，<span textstyle="">右侧面板实时预览文档最终状态</span>。用户可逐条审查建议，点击</span></font><span leaf="">"接受"应用修订、"跳过"保持原样、"撤回"回滚操作，所有修订操作都会被记录在`data/confirmations/`目录中，支持20步操作历史回滚。</span></h3><p><font face="宋体"><span leaf="">差异对比引擎基于段落</span></font><span leaf="">MD5哈希（前50字符）+段落索引双保险定位，使用CSS样式实现红底纹（原文）+绿底纹（建议）的直观对比效果，帮助用户快速理解每处修订的具体变化。修订状态包括pending（待处理）、accepted（已接受）、rejected（已拒绝）、modified（已修改）四种，完整记录每次修订的处理情况。</span><span><p></p></span></p><h3><b><font face="MS Gothic"><span leaf=""><span textstyle="">导出最终文档:</span></span></font></b><font face="宋体"><span leaf="">完成所有修订后，系统会自动生成</span></font><span leaf="">v2版本的最终申请书，保存在"data/output/"目录中，文档格式完全符合NSFC提交要求，可直接用于正式申报。最终文档包含完整的申请书正文、标准格式摘要表格、规范的章节标题与正文格式，用户只需补充（三）其他需要说明的情况等个人特定信息即可提交。</span><span><span leaf=""> </span></span></h3><section><span><span leaf=""><iframe data-src="https://mp.weixin.qq.com/mp/readtemplate?t=pages/video_player_tmpl&amp;action=mpvideo&amp;auto=0&amp;vid=wxv_4376642404699717645" data-mpvid="wxv_4376642404699717645" data-vidtype="2" data-cover="http%3A%2F%2Fmmbiz.qpic.cn%2Fsz_mmbiz_jpg%2FjjKyFnng2eG3AZjI3T4YoJIUS9gKp4qHO7oqzS21OUaTOpWb1YZVdDu0qtbib5MvLHia99AOgfgRaz0LB9ic4c9VkQrjnicxRzvRkegIp2eqDPo%2F0%3Fwx_fmt%3Djpeg" data-ratio="1.7777777777777777" data-w="1920"></iframe></span></span></section><section data-class="_mbEditor" data-id="2169746"><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><span leaf=""><br></span></section><section data-mid=""><span leaf=""><br></span></section></section><section data-mid=""><p data-mid=""><span leaf="">技术亮点</span></p></section></section></section></section></section></section><p><span leaf=""> </span><b><font face="MS Gothic"><span leaf=""><span textstyle="">智能权重分配:</span></span></font></b><font face="宋体"><span leaf="">系统自动基于章节编号分配内容质量要求，章节编号</span></font><font face="宋体"><span leaf="">≤2（立项依据、研究基础等核心章节）强制AI生成高质量内容，章节编号≥3（技术路线、研究方案等）可使用占位符或简述，确保重点章节内容充实。</span></font><span><span leaf="">SectionWeightManager模块通过解析文档结构自动识别章节编号，无需硬编码即可实现权重分配。核心章节（一、二）会获得更高的内容质量要求与生成长度限制，确保立项依据与研究基础部分的充分阐述。</span></span></p><h3><b><font face="MS Gothic"><span leaf=""><span textstyle="">差异化对比引擎:</span></span></font></b><font face="宋体"><span leaf="">基于段落</span></font><span leaf="">MD5哈希（前50字符）+段落索引双保险定位，使用CSS样式实现红底纹（原文）+绿底纹（建议）的直观对比效果，帮助用户快速理解每处修订的具体变化。</span><font face="宋体"><span leaf="">差异对比模块使用</span></font><span leaf="">difflib库进行文本差异分析，结合段落级别的定位机制确保修订建议的精准应用。即使文档内容有轻微变化，MD5哈希与段落索引的双重保障仍能准确定位目标段落。</span></h3><h3><b><font face="MS Gothic"><span leaf=""><span textstyle="">多模型支持架构:</span></span></font></b><font face="宋体"><span leaf="">支持</span></font><span leaf="">Kimi (kimi-thinking)、DeepSeek、豆包、通义千问等多模型配置，可根据不同任务特点为每位Agent单独指定AI模型，实现性能与成本的最优平衡。</span><font face="宋体"><span leaf="">系统内置了模型降级链机制，当主模型触发限流（</span></font><span leaf="">429错误）时自动切换到备用模型，确保撰写流程的连续性。指数退避重试策略在1秒→2秒→4秒的渐进延迟中平衡系统负载与用户体验。</span></h3><h3><b><font face="MS Gothic"><span leaf=""><span textstyle="">完整审计追踪:</span></span></font></b><font face="宋体"><span leaf="">运行日志位于</span></font><span leaf="">"logs/"目录，包含结构化运行日志与完整Agent行为链，确保整个撰写过程的透明性与可追溯性，方便用户了解每条建议的生成来源与依据。</span></h3><p><span leaf="">"grant_aide_YYYYMMDD.log"文件记录系统运行状态与错误信息，"agent_traces/"目录保存每个Agent的完整行为链，包括输入提示词、输出结果、处理时间等详细信息，为审计与调试提供完整数据支持。</span><span><p></p></span></p><section nodeleaf=""><img data-aistatus="1" data-imgfileid="100000499" data-ratio="2.0869565217391304" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/jjKyFnng2eGWTicTaRwZgxCQN9BXO8gadNkrXBJ1yNRfs9Gl2aIS3yhpzoRbyZDna6ViaytwCqlH5oLuvicyRmibOGhibJVzssLphmvmEOkqoeLM/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="299" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/jjKyFnng2eGWTicTaRwZgxCQN9BXO8gadNkrXBJ1yNRfs9Gl2aIS3yhpzoRbyZDna6ViaytwCqlH5oLuvicyRmibOGhibJVzssLphmvmEOkqoeLM/640?wx_fmt=png&amp;from=appmsg"></section><section data-class="_mbEditor" data-id="2169746"><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><section data-mid=""><span leaf=""><br></span></section><section data-mid=""><span leaf=""><br></span></section></section><section data-mid=""><p data-mid=""><span leaf="">下载链接</span></p></section></section></section></section></section></section><p><span leaf="">https://www.bioscitao.com/sites/2112.html</span></p><p><span><span leaf="">（目前版本为测试版本，不代表最终品质）</span><span leaf=""> </span></span></p><section nodeleaf=""><img data-aistatus="1" data-imgfileid="100000428" data-ratio="0.33203125" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/JvbYibcLUIZTZASMGvhk2HrDK2Rcz1ibqfRCojmzIWzsCp5kT1dpXhEwaNg2CZnLrKicuWmsFwgYDdM4aicPOxyCJw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1280" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/JvbYibcLUIZTZASMGvhk2HrDK2Rcz1ibqfRCojmzIWzsCp5kT1dpXhEwaNg2CZnLrKicuWmsFwgYDdM4aicPOxyCJw/640?wx_fmt=png&amp;from=appmsg"></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/wOp91a5rkJccaTdKrSAvCQ",target="_blank" rel="noopener noreferrer">原文链接</a>
