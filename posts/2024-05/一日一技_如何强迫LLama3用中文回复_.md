---
title: "一日一技：如何强迫LLama3用中文回复？"
date: 2024-05-11T01:37:58Z
draft: ["false"]
tags: [
  "fetched",
  "未闻Code"
]
categories: ["Duty"]
---
一日一技：如何强迫LLama3用中文回复？ by 未闻Code
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><br></p><p><img data-galleryid="" data-imgfileid="501504572" data-ratio="0.7490864799025578" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/ohoo1dCmvqfMOUlhbWwMbHicUMTNLzbWlia1UI2TtabsG21C3P4NFgmJl4tWC2xkJZdTiaibKO5AhUh1vVEsxh9WLA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1642" src="https://mmbiz.qpic.cn/mmbiz_png/ohoo1dCmvqfMOUlhbWwMbHicUMTNLzbWlia1UI2TtabsG21C3P4NFgmJl4tWC2xkJZdTiaibKO5AhUh1vVEsxh9WLA/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><section><span>摄影：产品经理</span></section><section><span>清水寺旁边的限量早餐</span><br></section><p><br></p><p><br></p><p data-tool="mdnice编辑器">最近大家都在说LLama3如何如何强大，追赶Claude3，超过GPT 4。但如果大家真的使用过，就会发现它连基本的中文都回答不好。如下图所示：<img data-imgfileid="501504569" data-ratio="0.8891928864569083" data-src="https://mmbiz.qpic.cn/mmbiz_png/ohoo1dCmvqfMOUlhbWwMbHicUMTNLzbWlGbw1cIa1TZqu8G0jJ5tjferH9icmlEiaLRdnYiaY0NDSkMU3dh6boAAKw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1462" src="https://mmbiz.qpic.cn/mmbiz_png/ohoo1dCmvqfMOUlhbWwMbHicUMTNLzbWlGbw1cIa1TZqu8G0jJ5tjferH9icmlEiaLRdnYiaY0NDSkMU3dh6boAAKw/640?wx_fmt=png&amp;from=appmsg">LLama3总是尽可能回复英文，并且还会加很多表情符号。</p><p data-tool="mdnice编辑器">今天网上出现了一个中文微调版的LLama3:<span>shenzhi-wang/Llama3-8B-Chinese-Chat</span><sup>[1]</sup>，我也下载下来使用了，发现确实回复都是中文了，但回复的都是车轱辘话，一句话反复说。如下图所示：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="501504568" data-ratio="0.2518597236981934" data-src="https://mmbiz.qpic.cn/mmbiz_png/ohoo1dCmvqfMOUlhbWwMbHicUMTNLzbWlicjQS8icroEeF5h9K5VOGmRHaRs6KE26ugxTRqAq558SNQt5BlyR03cQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="941" src="https://mmbiz.qpic.cn/mmbiz_png/ohoo1dCmvqfMOUlhbWwMbHicUMTNLzbWlicjQS8icroEeF5h9K5VOGmRHaRs6KE26ugxTRqAq558SNQt5BlyR03cQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">那么有没有什么办法，能够让LLama3既能回复中文，又能回复得聪明一些呢？网上有一段“生气的老奶奶”Prompt，可以尽可能让LLama3满足要求：</p><pre data-tool="mdnice编辑器"><span></span><code>问题<br><br>Rules:<br><br>- Be precise, <span>do</span> not reply emoji.<br>- Always response <span>in</span> Simplified Chinese, not English. or Grandma will be  very angry.<br></code></pre><p data-tool="mdnice编辑器">但如果每一个问题都加这么长一串，确实太麻烦了。</p><p data-tool="mdnice编辑器">这个时候，我们可以使用Ollama提供的创建新模型的方式，基于LLama 3 8b创建一个我们自己的模型。在创建时，把System信息写入进去。这样每次调用模型时就会自动生效了。</p><p data-tool="mdnice编辑器">首先，我们创建一个Modelfile文件，内容如下：</p><pre data-tool="mdnice编辑器"><span></span><code>from llama3<br><br>PARAMETER temperature 1<br>PARAMETER num_ctx 6000<br>PARAMETER top_k 50<br>PARAMETER top_p 0.95<br>SYSTEM <span>""</span><span>"<br>尽你的最大可能和能力回答用户的问题。不要重复回答问题。不要说车轱辘话。语言要通顺流畅。不要出现刚说一句话，过一会又重复一遍的愚蠢行为。<br><br>RULES:<br><br>- Be precise, do not reply emoji.<br>- Always response in Simplified Chinese, not English. or Grandma will be  very angry.<br>"</span><span>""</span><br></code></pre><p data-tool="mdnice编辑器">然后执行命令：<code>ollama create cusllama3 -f Modelfile</code>。构建我们自己的模型。如下图所示：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="501504567" data-ratio="0.42054794520547945" data-src="https://mmbiz.qpic.cn/mmbiz_png/ohoo1dCmvqfMOUlhbWwMbHicUMTNLzbWlbNc5pf8j3DibeUrklUkzEibYLCWIbbicu5HR0ybxpw9BpmEOQ4ATNqdjw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1460" src="https://mmbiz.qpic.cn/mmbiz_png/ohoo1dCmvqfMOUlhbWwMbHicUMTNLzbWlbNc5pf8j3DibeUrklUkzEibYLCWIbbicu5HR0ybxpw9BpmEOQ4ATNqdjw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">现在重新运行这个模型，输出效果如下图所示：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="501504566" data-ratio="0.9716088328075709" data-src="https://mmbiz.qpic.cn/mmbiz_png/ohoo1dCmvqfMOUlhbWwMbHicUMTNLzbWldVQUEE83s8A2iaAzgVa8M8b99ePIjEcIMqwXf7gBB7cFRxw8ibPcAp7g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="951" src="https://mmbiz.qpic.cn/mmbiz_png/ohoo1dCmvqfMOUlhbWwMbHicUMTNLzbWldVQUEE83s8A2iaAzgVa8M8b99ePIjEcIMqwXf7gBB7cFRxw8ibPcAp7g/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">这个效果，比他们微调后的版本好太多了。</p><section data-tool="mdnice编辑器"><span>参考资料</span></section><section data-tool="mdnice编辑器"><span><span>[1]</span><p>shenzhi-wang/Llama3-8B-Chinese-Chat: <em>https://huggingface.co/shenzhi-wang/Llama3-8B-Chinese-Chat</em></p></span></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><span>未闻Code Telegram Channel开通了！每天都有各种开发小技巧更新，速来！！</span></p><p><img data-galleryid="" data-imgfileid="501504577" data-ratio="1.2448979591836735" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/ohoo1dCmvqfEzNdl7ry40v1K3yobobZLicOHEicotHicpQVWamznHszyajQSJCklawpVVbRUUXjujfo010neibBw9w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="686" src="https://mmbiz.qpic.cn/mmbiz_png/ohoo1dCmvqfEzNdl7ry40v1K3yobobZLicOHEicotHicpQVWamznHszyajQSJCklawpVVbRUUXjujfo010neibBw9w/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器"><span></span></p></section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><p>END</p></section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><br></section></section></section></section></section><section powered-by="xiumi.us"><section powered-by="xiumi.us"><section><img data-imgfileid="501504576" data-ratio="0.549074074074074" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/ohoo1dCmvqcLS5eIyiaZwBibFZxQ0rY6Cxqniaud08QzpsQje8n4junXCTJ0Z7weSCiaDr9DnaYrPqLEMIm1nMxfdQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/ohoo1dCmvqcLS5eIyiaZwBibFZxQ0rY6Cxqniaud08QzpsQje8n4junXCTJ0Z7weSCiaDr9DnaYrPqLEMIm1nMxfdQ/640?wx_fmt=jpeg"></section></section><section powered-by="xiumi.us"><p><span>未闻 Code·知识星球开放啦！</span></p><p>一对一答疑爬虫相关问题</p><p>职业生涯咨询</p><p>面试经验分享</p><p>每周直播分享</p><p>......</p><p>未闻 Code·知识星球期待与你相见~</p></section><p><img data-cropselx1="0" data-cropselx2="524" data-cropsely1="0" data-cropsely2="291" data-ratio="0.5555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_gif/ohoo1dCmvqdibWI839rMdKvybARQ46RLEMxasjDASe6tgoJDOk7RibADqoqykrOX4uux8euic2wYGcp6iajaVyCzsQ/640?wx_fmt=gif" data-type="gif" data-w="639" data-imgfileid="501504575" src="https://mmbiz.qpic.cn/mmbiz_gif/ohoo1dCmvqdibWI839rMdKvybARQ46RLEMxasjDASe6tgoJDOk7RibADqoqykrOX4uux8euic2wYGcp6iajaVyCzsQ/640?wx_fmt=gif"><br></p></section><section powered-by="xiumi.us"><p>一二线大厂在职员工</p><p>十多年码龄的编程老鸟</p><p>国内外高校在读学生</p><p>中小学刚刚入门的新人</p><p>在<span>“未闻 Code技术交流群”</span>等你来！</p><p><span><em>入群方式：添加微信“mekingname”，备注“粉丝群”（谢绝广告党，非诚勿扰！)</em></span></p><p><br></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/EonqaZIKvT7vd9Yavp4tAw",target="_blank" rel="noopener noreferrer">原文链接</a>
