---
title: "ggplot2全面教程笔记"
date: 2022-12-01T09:10:47Z
draft: ["false"]
tags: [
  "fetched",
  "生信小知识"
]
categories: ["Duty"]
---
ggplot2全面教程笔记 by 生信小知识
------
<div><section><h2><span>ggplot2全面教程笔记</span></h2><blockquote><p>微信公众号：<strong>生信小知识</strong><br>关注可了解更多的生物信息学教程及知识。问题或建议，请公众号留言;</p></blockquote><h3><span>目录</span></h3><p><span><span>前言</span></span><span><span>1. 学习逻辑</span></span><span><span>2. 数据(data) 和 映射（Mapping）</span></span><span><span>3. 几何对象（Geometric）</span></span><span><span><span>3.1 直方图——提供一个连续变量，画出数据的分布</span></span></span><span><span><span>3.2 柱状图——提供一个分类变量，画出数据的分布</span></span></span><span><span><span><span>3.2.1 直方图与柱状图的区分与联系</span></span></span></span><span><span><span>3.3 箱式图</span></span></span><span><span>4. 标尺（Scale）</span></span><span><span><span>4.1 颜色标尺设置（color fill）</span></span></span><span><span><span><span>4.1.1 更改离散型变量的颜色函数</span></span></span></span><span><span><span><span>4.1.2 更改连续型变量的颜色函数</span></span></span></span><span><span><span>4.2 坐标轴标尺修改（x , y）</span></span></span><span><span><span><span>4.2.1 一些简单偷懒的方法</span></span></span></span><span><span>5. 统计变换（Statistics）</span></span><span><span><span>5.1 stat_summary</span></span></span><span><span><span>5.2 stat_smooth</span></span></span><span><span>6. 坐标系统（Coordinante）</span></span><span><span><span>6.1 coord_flip() 实现坐标轴翻转</span></span></span><span><span><span>6.2 coord_polar()实现极坐标转换</span></span></span><span><span>7. 分面（Facet）</span></span><span><span>8. 主题（Theme）</span></span><span><span><span>8.1 theme 参数</span></span></span><span><span><span><span>8.1.1 修改标题，坐标轴</span></span></span></span><span><span><span><span>8.1.2 修改图例</span></span></span></span><span><span><span><span>8.1.3 修改绘图背景，主轴和次轴</span></span></span></span><span><span><span>8.2 相关主题</span></span></span><span><span><span><span>8.2.1 ggplot2默认主题</span></span></span></span><span><span><span><span>8.2.2 扩展包主题</span></span></span></span><span><span>9. 其他小知识</span></span><span><span><span>9.1 多张图合并</span></span></span><span><span><span>9.2 额外添加直线</span></span></span><span><span><span><span>9.2.1 设置为虚线</span></span></span></span><span><span><span>9.3 坐标轴中间设置中断</span></span></span><span><span><span>9.4 改变字体大小</span></span></span><span><span><span><span>9.4.1 倍数改变</span></span></span></span><span><span><span><span>9.4.2 指定具体大小</span></span></span></span><span><span><span>9.5 坐标轴上label旋转</span></span></span><span><span><span>9.6 图片上特定地方添加字母label</span></span></span><span><span>后记</span></span></p><h3><span>前言</span></h3><p>用R的人，人人都知道ggplot2的强大，但是作为一个懒人，我只知道ggplot2的最基本用法，每次都是画什么图就去google找代码，这使得我在使用过程中没法根据自己的想法做变换。</p><p>为了解决这个问题，我决定画点时间来整理下ggplot2的系统用法。</p><blockquote><p>本文主要使用经典的mtcars数据集和diamonds数据集子集为例来画图。</p></blockquote><p>环境载入：</p><pre><code>rm(list = ls())<br>options(stringAsFactors = <span>F</span>)<br><span>#install.packages("ggplot2")</span><br><span>library</span>(ggplot2)<br>set.seed(<span>1234</span>)<br><br>mtcars &lt;- mtcars<br>data(diamonds)<br>diamond &lt;- diamonds[sample(nrow(diamonds), <span>2000</span>), ]<br></code></pre><p>本文参考：</p><ul><li><p><span>ggplot2|详解八大基本绘图要素：https://zhuanlan.zhihu.com/p/77875382</span></p></li></ul><h3><span>1. 学习逻辑</span></h3><p>本文将从ggplot2的七大基本要素逐步介绍这个强大的R可视化包。</p><ul><li><p><span>数据（Data）和映射（Mapping）</span></p></li><li><p><span>几何对象（Geometric）</span></p></li><li><p><span>标尺（Scale）</span></p></li><li><p><span>统计变换（Statistics）</span></p></li><li><p><span>坐标系统（Coordinante）</span></p></li><li><p><span>分面（Facet）</span></p></li><li><p><span>主题（Theme）</span></p></li></ul><p>当然，最后也会补充一些画图常常需要用到的小技巧，例如x轴label的旋转、添加辅助线等等。</p><h3><span>2. 数据(data) 和 映射（Mapping）</span></h3><blockquote><p><strong>映射：aes()</strong>函数是ggplot2中的映射函数, 所谓的映射即为数据集中的数据关联到相应的图形属性过程中一种对应关系, 图形的颜色，形状，分组等都可以通过通过数据集中的变量映射。</p></blockquote><p>使用diamonds的数据子集作为绘图数据，克拉(carat)数为X轴变量，价格(price)为Y轴变量：</p><pre><code>ggplot(data = diamond, mapping = aes(x = carat, y = price))<br></code></pre><figure><figcaption><img data-ratio="0.9236363636363636" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfVdx10Vte0BTV1ibYv5hWVfftVFrr57ET402qpjT96ogbJSwqQVX6dibg/640?wx_fmt=png" data-type="png" data-w="825" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfVdx10Vte0BTV1ibYv5hWVfftVFrr57ET402qpjT96ogbJSwqQVX6dibg/640?wx_fmt=png"></figcaption></figure><p>这里为什么没有结果呢？这是因为我们只告诉了ggplot我们x和y轴用什么数据来影射，但是没有告诉它要画成什么图。如果我们告诉它我们要画点图：</p><pre><code>ggplot(data = diamond, mapping = aes(x = carat, y = price))+geom_point()<br></code></pre><figure><figcaption><img data-ratio="0.9119420989143546" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfhA7ENXAw1iajjiamibdjcwlzppD4iadoRfJBQkN7DiayaRSosLSBTia1icIwg/640?wx_fmt=png" data-type="png" data-w="829" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfhA7ENXAw1iajjiamibdjcwlzppD4iadoRfJBQkN7DiayaRSosLSBTia1icIwg/640?wx_fmt=png"><br></figcaption>除了x和y轴坐标可以映射外，图形上每个点的颜色、形状等都可以映射：</figure><pre><code>ggplot(data = diamond) + geom_point(aes(x=carat, y=price, colour=color))<span># 颜色映射（左图）</span><br>ggplot(data = diamond) + geom_point(aes(x=carat, y=price, shape=cut))<span># 形状映射（右图）</span><br>ggplot(data = diamond) + geom_point(aes(x=carat, y=price, colour=color,shape=cut))<span># 颜色+映射</span><br></code></pre><figure><img data-ratio="0.5474613686534217" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfzQmyPhvYD3651gZicsUDibA1dG9icdDpFsHGv9aarflw1F3cIQEZry0VQ/640?wx_fmt=png" data-type="png" data-w="1359" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfzQmyPhvYD3651gZicsUDibA1dG9icdDpFsHGv9aarflw1F3cIQEZry0VQ/640?wx_fmt=png"><figcaption><br></figcaption></figure><h3><span>3. 几何对象（Geometric）</span></h3><blockquote><p><strong>几何对象</strong>代表我们在图中实际看到的图形元素，如点、线、多边形等。数据与映射部分介绍了ggplot函数执行各种属性映射，只需要添加不同的几何对象图层，即可绘制出相应的图形。</p></blockquote><p>此处介绍几种常用的几何对象：</p><ul><li><p><code>geom_histogram</code>用于直方图</p></li><li><p><code>geom_bar</code>用于画柱状图</p></li><li><p><code>geom_boxplot</code>用于画箱式图</p></li></ul><h4><span>3.1 直方图——提供一个连续变量，画出数据的分布</span></h4><p>以价格（price）变量为例，且按照不同的切工填充颜色：</p><pre><code>ggplot(diamond)+geom_histogram(aes(x=price, fill=cut))<br></code></pre><figure><img data-ratio="0.8023133543638276" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfZAdttbjAbmeMo3AicMKGA9vGTkpFXg3h2JFjyREIw81WIBdtIwuejRw/640?wx_fmt=png" data-type="png" data-w="951" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfZAdttbjAbmeMo3AicMKGA9vGTkpFXg3h2JFjyREIw81WIBdtIwuejRw/640?wx_fmt=png"></figure><p>设置position="dodge"，side-by-side地画直方图：</p><pre><code>ggplot(diamond)+geom_histogram(aes(x=price, fill=cut), position=<span>"dodge"</span>)<br></code></pre><figure><img data-ratio="0.8018967334035827" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfpL5ucGoiaoyngrL890rGDXXMZIgre07s3Hz6HacfT7ElpT5ibciaBad0w/640?wx_fmt=png" data-type="png" data-w="949" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfpL5ucGoiaoyngrL890rGDXXMZIgre07s3Hz6HacfT7ElpT5ibciaBad0w/640?wx_fmt=png"><figcaption><br></figcaption></figure><p>设置使用position="fill"，按相对比例画直方图：</p><pre><code>ggplot(diamond)+geom_histogram(aes(x=price, fill=cut), position=<span>"fill"</span>)<br></code></pre><figure><img data-ratio="0.8010526315789473" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfmdCsoHvDNm2HkPibXOIo6rqHGOCBa3BKl4TCLz4ghLlPrFicVrLoOnrw/640?wx_fmt=png" data-type="png" data-w="950" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfmdCsoHvDNm2HkPibXOIo6rqHGOCBa3BKl4TCLz4ghLlPrFicVrLoOnrw/640?wx_fmt=png"></figure><h4><span>3.2 柱状图——提供一个分类变量，画出数据的分布</span></h4><p>以透明度（clarity）变量为例，且按照不同的切工填充颜色，<strong>柱子的高度即为此分类下的数目</strong>：</p><pre><code>ggplot(diamond)+geom_bar(aes(x=clarity, fill=cut))<br></code></pre><figure><img data-ratio="0.8054968287526427" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfPqlnoUJ3BSSsnPfAQz2iaZAwmNYF41ZLHXeju523MBRzoLpGevzQe4w/640?wx_fmt=png" data-type="png" data-w="946" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfPqlnoUJ3BSSsnPfAQz2iaZAwmNYF41ZLHXeju523MBRzoLpGevzQe4w/640?wx_fmt=png"></figure><p><strong>直接指定个数</strong>，需要通过<code>stat</code>参数，指定<code>geom_bar</code>按特定高度画图：</p><pre><code>ggplot()+geom_bar(aes(x=c(LETTERS[<span>1</span>:<span>5</span>]),y=<span>1</span>:<span>5</span>), stat=<span>"identity"</span>)<br></code></pre><figure><img data-ratio="0.7941787941787942" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfKKicsA69MDyhxShcDly7ejlJg45Gh09IwUZf4D2qztS8QTmfGeJwUzQ/640?wx_fmt=png" data-type="png" data-w="962" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfKKicsA69MDyhxShcDly7ejlJg45Gh09IwUZf4D2qztS8QTmfGeJwUzQ/640?wx_fmt=png"></figure><h5><span>3.2.1 直方图与柱状图的区分与联系</span></h5><ul><li><p><span>直方图：把连续型的数据按照一个个等长的分区（bin）切分，然后计数画柱形图。</span></p></li><li><p><span>柱状图：把分类数据，按类别计数。</span></p></li></ul><h4><span>3.3 箱式图</span></h4><blockquote><p>箱线图通过绘制观测数据的五数总括，即最小值、下四分位数、中位数、上四分位数以及最大值，描述了变量值的分布情况。同时箱线图能够显示出离群点（outlier），通过箱线图能够很容易识别出数据中的异常值。</p></blockquote><p>按切工(cut)分类，对价格(price)变量画箱式图，再按照color变量分别填充颜色。</p><pre><code>ggplot(diamond)+geom_boxplot(aes(x=cut, y=price,fill=color))<br></code></pre><figure><img data-ratio="0.8014783526927138" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfImq9EAAXLrU6J4ruibxOhxFYlfKXIepCKK7cNicGPxYYGn8AgutBA5VA/640?wx_fmt=png" data-type="png" data-w="947" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfImq9EAAXLrU6J4ruibxOhxFYlfKXIepCKK7cNicGPxYYGn8AgutBA5VA/640?wx_fmt=png"></figure><h3><span>4. 标尺（Scale）</span></h3><blockquote><p>在对图形属性进行映射之后，使用标尺可以控制这些属性的显示方式，比如坐标刻度，颜色属性等。</p><p>ggplot2的scale系列函数有很多，命名和用法是有一定规律的。一般<strong>使用三个单词</strong>用 "<code>_</code>" 连接，如<code>scale_fill_gradient</code>和 <code>scale_x_continuous</code> 等，其规律总结如下：</p><ul><li><p><span>第一个都是scale</span></p></li><li><p>第二个是 <code>color</code>， <code>alpha</code>， <code>fill</code>， <code>x</code>， <code>y</code>， <code>linetype</code>， <code>shape</code>， <code>size</code> 等可更改的参数</p></li><li><p>第三个是具体的类型，如 连续型 <code>continuous</code>，离散型 <code>discrete</code> 等</p></li></ul></blockquote><p>这里放一个简单的命名总结：</p><blockquote><p><strong>通用设置</strong>：* 可用 <code>alpha</code>, <code>color</code>, <code>fill</code>, <code>linetype</code>, <code>shape</code>, <code>size</code>替换：</p><p><code>scale_*_continuous()</code>：设置<strong>连续</strong>型数值<br><code>scale_*_discrete()</code>：设置<strong>离散</strong>型数值<br><code>scale_*_identity()</code>：<br><code>scale_*_manual(values = c())</code>：更加自定义设置</p><p><strong>x、y坐标设置</strong>：</p><ul><li><p><code>scale_x_date(labels = date_format("%m/%d"), breaks = date_breaks("2 weeks"))</code>：设置时间格式</p></li><li><p><code>scale_x_datetime()</code>：设置日期格式</p></li><li><p><code>scale_x_log10()</code>：将x数值转换为log10的形式</p></li><li><p><code>scale_x_reverse()</code>：x轴逆序绘制</p></li><li><p><code>scale_x_sqrt()</code>：将x数值转换为平方的形式</p></li></ul><p><strong>颜色及填充设置（离散型数据）</strong>：</p><ul><li><p><code>n + scale_fill_brewer(palette = "Blues")</code>：填充为蓝色</p></li><li><p><code>n + scale_fill_grey(start = 0.2, end = 0.8, na.value = "red")</code>：填充为红色</p></li></ul><p><strong>颜色及填充设置（连续型数据）</strong>：</p><ul><li><p><code>o + scale_fill_gradient( low = "red", high = "yellow")</code>：从小到大，小的填充为红色，大的填充为黄色</p></li><li><p><code>o + scale_fill_gradient2( low = "red", hight = "blue", mid = "white", midpoint = 25)</code>：从小到大，小的填充为红色，大的填充为蓝色，中间（25）用黄色过渡</p></li><li><p><code>o + scale_fill_gradientn(colours = terrain.colors(6))</code>：使用6个连续型颜色进行填充</p></li></ul><p>图中图形点大小的设置：</p><ul><li><p><code>q + scale_size_area(max = 6)</code></p></li></ul></blockquote><h4><span>4.1 颜色标尺设置（color fill）</span></h4><p>颜色的函数名第二个单词有 <code>color</code> 和 <code>fill</code> 两个，对应分组使用的颜色函数即可。</p><p>颜色标尺<strong>第三个单词选择方法</strong>：</p><ul><li><p><strong>离散型</strong>：在颜色变量是离散变量的时候使用，比如分类时每一类对应一种颜色</p></li><li><p><span>manual：直接指定分组使用的颜色</span></p></li><li><p><span>hue：通过改变色相（hue）饱和度（chroma）亮度（luminosity）来调整颜色</span></p></li><li><p><span>brewer：使用ColorBrewer的颜色</span></p></li><li><p><strong>grey</strong>：使用不同程度的灰色</p></li><li><p><strong>连续型</strong>：颜色变量是连续变量的时候使用，比如0-100的数，数值越大颜色越深这样</p></li><li><p><strong>gradient</strong>：创建渐变色</p></li><li><p><span>distiller：使用ColorBrewer的颜色</span></p></li><li><p>identity：使用color变量对应的颜色，<strong>对离散型和连续型都有效</strong></p></li></ul><h5><span>4.1.1 更改离散型变量的颜色函数</span></h5><ol><li><p><strong>manual 直接指定分组使用的颜色</strong></p></li></ol><pre><code><span>#左上</span><br>p1 &lt;- ggplot(diamond)+geom_bar(aes(x=color,fill=cut))<br><span>#直接指定颜色 （右上）</span><br>p2 &lt;- p1 + scale_fill_manual(values=c(<span>"red"</span>, <span>"blue"</span>, <span>"green"</span>,<span>"yellow"</span>,<span>"orange"</span>))<br><span>#对应分组指定 （左下）</span><br>p3 &lt;- p1 + scale_fill_manual(values=c(<span>"Fair"</span> = <span>"red"</span>, <span>"Good"</span> = <span>"blue"</span>, <span>"Very Good"</span> = <span>"green"</span>, <span>"Premium"</span> = <span>"orange"</span>, <span>"Ideal"</span> = <span>"yellow"</span>))<br><span>#更改图例名字,对应指定并更改图例标签 （右下）</span><br>p4 &lt;- p1 + scale_fill_manual(name=<span>"Label"</span>, values=c(<span>"red"</span>, <span>"blue"</span>, <span>"green"</span>,<span>"yellow"</span>,<span>"orange"</span>), breaks = c(<span>"Fair"</span>, <span>"Good"</span>, <span>"Very Good"</span>,<span>"Premium"</span>,<span>"Ideal"</span>),labels = c(<span>"一般"</span>, <span>"好"</span>, <span>"很好"</span>, <span>"高级"</span>, <span>"理想"</span>))<br><br>p1+p2+p3+p4<br></code></pre><figure><img data-ratio="0.7957219251336899" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfCqVxQlcpKYzmTOfib9USibTEKWfFoL49gNYDVnEyLv4XOyr9Y4tdTzew/640?wx_fmt=png" data-type="png" data-w="935" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfCqVxQlcpKYzmTOfib9USibTEKWfFoL49gNYDVnEyLv4XOyr9Y4tdTzew/640?wx_fmt=png"></figure><ol start="2"><li><p><strong>palette参数调用色板</strong></p></li></ol><pre><code><span>library</span>(RColorBrewer)<br><span># scale_fill_brewer() 常用的参数有3个：</span><br><span># 1. type：选择不同的颜色类型seq (sequential), div (diverging) or qual (qualitative)</span><br><span># 2. palette：选择预制的色板，数字或者字符</span><br><span># 3. direction：1 or -1,顺序或者逆序</span><br><br><span># 默认使用Blues调色板中的颜色（左上）</span><br>pa = p1 + scale_fill_brewer()<br><span>#使用Greens调色板中的颜色，以字母表示 （右上）</span><br>pb = p1 + scale_fill_brewer(palette = <span>"Greens"</span>)<br><span>#使用Greens调色板中的颜色，以数字表示 （左下）</span><br>pc = p1 + scale_fill_brewer(palette = <span>2</span>)<br><span>#使用Greens调色板中的颜色，逆序表示 （右下）</span><br>pd = p1 + scale_fill_brewer(palette = <span>2</span>,direction = -<span>1</span>)<br>pa + pb + pc + pd<br></code></pre><figure><img data-ratio="0.6046255506607929" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfK350m4EowLAtNDl4Vtbg9xYrAdChrhClLxAgFInEVOXT3k4N2yaMuQ/640?wx_fmt=png" data-type="png" data-w="908" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfK350m4EowLAtNDl4Vtbg9xYrAdChrhClLxAgFInEVOXT3k4N2yaMuQ/640?wx_fmt=png"></figure><ol start="3"><li><p><strong>grey 使用不同程度的灰色</strong></p></li></ol><pre><code>p &lt;- ggplot(diamond)+geom_bar(aes(x=color,fill=cut))<br><span># 0黑色；1白色</span><br><span># 左上图，默认灰度从0.2-0.8</span><br>p1 = p + scale_fill_grey()<br><span># 右上图灰度从1-0</span><br>p2 = p + scale_fill_grey(start=<span>1</span>, end=<span>0</span>)<br>p1 + p2<br></code></pre><figure><img data-ratio="0.6046255506607929" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryficbw8oNrASXSQviaO5f9V0shc5hNiblHWkicTUjPAp8g0aH4May8KnSadA/640?wx_fmt=png" data-type="png" data-w="908" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryficbw8oNrASXSQviaO5f9V0shc5hNiblHWkicTUjPAp8g0aH4May8KnSadA/640?wx_fmt=png"></figure><h5><span>4.1.2 更改连续型变量的颜色函数</span></h5><ol><li><p>通过 <code>color</code> 指定连续型数据完成渐变色：</p></li></ol><pre><code>ggplot(diamond) + geom_point(aes(x, y,color = z))<br></code></pre><figure><img data-ratio="0.6046255506607929" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryf9m4brcSBVGw8uribDtAHurgiaWFc7iaeADS3Olqp7Z6QFJX8IG73uMTPQ/640?wx_fmt=png" data-type="png" data-w="908" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryf9m4brcSBVGw8uribDtAHurgiaWFc7iaeADS3Olqp7Z6QFJX8IG73uMTPQ/640?wx_fmt=png"></figure><ol start="2"><li><p><strong>gradient 创建渐变色</strong></p></li></ol><pre><code><span>#以连续数值作为渐变色映射 (左上)</span><br>p &lt;- ggplot(diamond) + geom_point(aes(x, y,color=z))<br><span>#设置两端颜色 (中上)</span><br>p1 &lt;- p + scale_color_gradient(low = <span>"white"</span>, high = <span>"black"</span>)<br><span>#展示指定标签  (右上)</span><br>p2 &lt;- p + scale_color_gradient(low = <span>"white"</span>, high = <span>"black"</span>, breaks=c(<span>3</span>,<span>4</span>,<span>5</span>),  labels=c(<span>"a"</span>,<span>"b"</span>,<span>"c"</span>))<br><span>#指定legend名称,并指定颜色展示范围 (左下)</span><br>p3 &lt;- p + scale_color_gradient(name=<span>"Legend"</span>, low = <span>"white"</span>, high = <span>"black"</span>, limits=c(<span>3</span>,<span>5</span>))<br><span>#设置中间过渡色 (中下)</span><br>p4 &lt;- p + scale_color_gradient2(low = <span>"red"</span>, mid = <span>"white"</span>, high = <span>"blue"</span>, midpoint = <span>4</span>)<br><span>#使用R预设调色板 (右下)</span><br>p5 &lt;- p + scale_color_gradientn(colours =rainbow(<span>10</span>))<br><br>p + p1 + p2 + p3 + p4 + p5<br></code></pre><figure><img data-ratio="0.48663101604278075" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfhPZOibVzd7twuRZqZCShGkiacNyJ9aWozVxCeW6PXknQZUDmpuYM2kWw/640?wx_fmt=png" data-type="png" data-w="1122" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfhPZOibVzd7twuRZqZCShGkiacNyJ9aWozVxCeW6PXknQZUDmpuYM2kWw/640?wx_fmt=png"></figure><ol start="3"><li><p><strong>distiller 使用ColorBrewer的颜色</strong></p></li></ol><pre><code><span>#以连续数值作为渐变色映射 (左)</span><br>p &lt;- ggplot(diamond) + geom_point(aes(x, y,color=z))<br><span>#中</span><br>p2 &lt;- p + scale_color_distiller(palette = <span>"Spectral"</span>)<br><span>#右</span><br>p3 &lt;- p + scale_color_distiller(palette = <span>"Greens"</span>)<br><br>p + p2 + p3<br></code></pre><figure><img data-ratio="0.6046255506607929" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfWpB8CkAeSvzF07ibG1ob0ehicdcLK552X0TlqPBIFbGcd1KkaK6mxaAA/640?wx_fmt=png" data-type="png" data-w="908" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfWpB8CkAeSvzF07ibG1ob0ehicdcLK552X0TlqPBIFbGcd1KkaK6mxaAA/640?wx_fmt=png"></figure><h4><span>4.2 坐标轴标尺修改（x , y）</span></h4><p>本部分主要是对坐标轴做如下改变，</p><ul><li><p><span>更改坐标轴名称</span></p></li><li><p><span>更改x轴上标数的位置和内容</span></p></li><li><p><span>显示对一个轴做统计变换</span></p></li><li><p><span>只展示一个区域内的点</span></p></li><li><p><span>更改刻度标签的位置</span></p></li></ul><p>实现上面的这些可以使用 <code>scale_x</code> 等函数，同时像 <code>xlab</code> 这样的函数实现其中某一方面的功能，但是<strong>用起来更加方便</strong></p><p>因为这里的数据也有<strong>连续和之分</strong>，所以也要使用不同的函数来实现。</p><ol><li><p><strong>x坐标是离散变量</strong>，y坐标是连续变量：<strong>修改x轴</strong></p></li></ol><pre><code><span># x坐标是离散变量，y坐标是连续变量</span><br>p &lt;- ggplot(mtcars, aes(factor(cyl), mpg)) + geom_point()<br><span># 更改坐标轴名称</span><br>p2 &lt;- p + scale_x_discrete(name = <span>"cyl"</span>)<br><span># 更改横轴标度名称</span><br>p3 &lt;- p + scale_x_discrete(labels = c(<span>"4"</span>=<span>"a"</span>,<span>"6"</span>=<span>"b"</span>,<span>"8"</span>=<span>"c"</span>))<br><span># 指定横轴顺序以及展示部分</span><br>p4 &lt;- p + scale_x_discrete(limits=c(<span>"6"</span>,<span>"4"</span>))<br><br>p + p2 + p3 + p4<br></code></pre><figure><img data-ratio="0.6390465380249716" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfxGibBUw1NGlmgPkCeA29yP1pZn943pmsqDtb4ABfKhyRHqcJ40ibMxGA/640?wx_fmt=png" data-type="png" data-w="881" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfxGibBUw1NGlmgPkCeA29yP1pZn943pmsqDtb4ABfKhyRHqcJ40ibMxGA/640?wx_fmt=png"></figure><ol start="2"><li><p>x坐标是离散变量，<strong>y坐标是连续变量</strong>：<strong>修改y轴</strong></p></li></ol><pre><code><span># 更改坐标轴名称</span><br>p1 &lt;- p + scale_y_continuous(name=<span>"ylab_mpg"</span>)<br><span># 指定横轴展示部分</span><br>p2 &lt;- p + scale_y_continuous(breaks = c(<span>10</span>,<span>20</span>,<span>30</span>))<br><span># 更改横轴标度名称</span><br>p3 &lt;- p + scale_y_continuous(breaks = c(<span>10</span>,<span>20</span>,<span>30</span>), labels=c(<span>"$10"</span>,<span>"$20"</span>,<span>"$30"</span>))<br><span># 限定定横轴展示部分</span><br>p4 &lt;- p + scale_y_continuous(limits = c(<span>10</span>,<span>20</span>))<br><br>p1 + p2 + p3 + p4<br></code></pre><figure><img data-ratio="0.6736621196222455" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryf53FB0j0vVe5ibz5tQibFpX2qNREjLnXDhWYm4oxQGqj1icFRIbtrKrgaA/640?wx_fmt=png" data-type="png" data-w="953" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryf53FB0j0vVe5ibz5tQibFpX2qNREjLnXDhWYm4oxQGqj1icFRIbtrKrgaA/640?wx_fmt=png"></figure><ol start="3"><li><p>x坐标是离散变量，<strong>y坐标是连续变量</strong>：<strong>修改y轴变换</strong></p></li></ol><pre><code><span># 纵坐标翻转，小数在上面，大数在下面</span><br>p + scale_y_reverse()<br></code></pre><figure><img data-ratio="0.847723704866562" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryf4zbV6ueC8wole2ODUn2NGAD7Jx9M6TdZywvK61sGia0Wl8Driaqs2iasw/640?wx_fmt=png" data-type="png" data-w="637" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryf4zbV6ueC8wole2ODUn2NGAD7Jx9M6TdZywvK61sGia0Wl8Driaqs2iasw/640?wx_fmt=png"></figure><ol start="4"><li><p><span>更改刻度标签的位置</span></p></li></ol><pre><code>p + scale_x_discrete(position = <span>"top"</span>) +  scale_y_continuous(position = <span>"right"</span>)<br></code></pre><figure><img data-ratio="0.8541996830427893" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfiaZknqXzGzeNbWTFUfkOWYWiaicfibVE54iakerb5qBgiaPM7BDKDPHpf8zQ/640?wx_fmt=png" data-type="png" data-w="631" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfiaZknqXzGzeNbWTFUfkOWYWiaicfibVE54iakerb5qBgiaPM7BDKDPHpf8zQ/640?wx_fmt=png"></figure><h5><span>4.2.1 一些简单偷懒的方法</span></h5><pre><code>p &lt;- ggplot(mtcars, aes(factor(cyl), mpg)) + geom_point()<br><span># 使用更简单易用 的函数</span><br>p + xlab(<span>"cyl"</span>)<br>p + labs(x = <span>"cyl"</span>)<br>p + ggtitle(<span>"ggtitle"</span>,subtitle = <span>"subtitle"</span>)<br>p + xlim(c(<span>"4"</span>,<span>"6"</span>))<br></code></pre><figure><img data-ratio="0.7772215269086358" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfBicdGUws5HGO1qYv5BBveWXicBScPKwO7u3RK6BqlkfdNjX1WQZzgbjw/640?wx_fmt=png" data-type="png" data-w="799" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfBicdGUws5HGO1qYv5BBveWXicBScPKwO7u3RK6BqlkfdNjX1WQZzgbjw/640?wx_fmt=png"></figure><h3><span>5. 统计变换（Statistics）</span></h3><p>ggplot2提供了多种统计变换方式，此处介绍两种较常用的。</p><h4><span>5.1 stat_summary</span></h4><p>要求数据源的y能够被分组，每组不止一个元素, 或增加一个分组映射，即aes(x= , y = , group = )</p><pre><code>g &lt;- ggplot(mtcars,aes(x=cyl, y=mpg)) + geom_point()<br><span># 计算最大值，以点显示</span><br>p1 &lt;- g + stat_summary(fun = <span>"max"</span>, color = <span>"red"</span>, size = <span>2</span>, geom = <span>"point"</span>)<br><span># 计算最小值，以线显示</span><br>p2 &lt;- g + stat_summary(fun = <span>"min"</span>, color = <span>"red"</span>, size = <span>0.6</span>, geom = <span>"line"</span>)<br><span># 计算均值，以点显示</span><br>p3 &lt;- g + stat_summary(fun = <span>"mean"</span>, color = <span>"red"</span>, size = <span>2</span>, geom = <span>"point"</span>)<br><span># 计算中位值，以点显示</span><br>p4 &lt;- g + stat_summary(fun = <span>"median"</span>, color = <span>"red"</span>, size = <span>2</span>, geom = <span>"point"</span>)<br><br>p1+p2+p3+p4<br></code></pre><figure><img data-ratio="0.5923159018143009" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfZtpqtIK5KibTDeyQibJjm4jsPib8WBWicUoCmrSK3aOQ9qvwUz5EZklJMA/640?wx_fmt=png" data-type="png" data-w="937" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfZtpqtIK5KibTDeyQibJjm4jsPib8WBWicUoCmrSK3aOQ9qvwUz5EZklJMA/640?wx_fmt=png"><figcaption><br></figcaption></figure><h4><span>5.2 stat_smooth</span></h4><p>对原始数据进行某种统计变换计算，然后在图上表示出来，例如对散点图上加一条回归线。</p><pre><code>p &lt;- ggplot(mpg, aes(displ, hwy))+geom_point()<br><span># 默认loess拟合，默认有置信区间</span><br>p1 &lt;- p+stat_smooth()<br><span># 使用线性拟合，去除置信区间</span><br>p2 &lt;- p+stat_smooth(method = lm, se = <span>F</span>)<br><br>p+p1+p2<br></code></pre><figure><img data-ratio="0.37851929092805003" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfAOHjsy01icE33FAVISJwTzqAJhpic4xuqHUuia7CpzI5gpFc3XkialI6oQ/640?wx_fmt=png" data-type="png" data-w="959" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfAOHjsy01icE33FAVISJwTzqAJhpic4xuqHUuia7CpzI5gpFc3XkialI6oQ/640?wx_fmt=png"></figure><h3><span>6. 坐标系统（Coordinante）</span></h3><p>坐标系统控制坐标轴，可以进行变换，例如XY轴翻转，笛卡尔坐标和极坐标转换，以满足我们的各种需求。</p><h4><span>6.1 coord_flip() 实现坐标轴翻转</span></h4><pre><code>p &lt;- ggplot(diamond)+geom_bar(aes(x=cut, fill=cut))<br><span># x和y轴翻转</span><br>p1 &lt;- p + coord_flip()<br>p/p1<br></code></pre><figure><img data-ratio="0.8673780487804879" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfT9CJNiaDnFSJeCjkSHWs0XeV7rR9K8iaMHvziasxAnJsgOpBWy2zdUymQ/640?wx_fmt=png" data-type="png" data-w="656" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfT9CJNiaDnFSJeCjkSHWs0XeV7rR9K8iaMHvziasxAnJsgOpBWy2zdUymQ/640?wx_fmt=png"></figure><h4><span>6.2 coord_polar()实现极坐标转换</span></h4><pre><code>p &lt;- ggplot(diamond)+geom_bar(aes(x=cut, fill=cut))<br><span># x和y轴翻转</span><br>p1 &lt;- p + coord_polar(theta=<span>"y"</span>)<br>p+p1<br></code></pre><figure><img data-ratio="0.3867924528301887" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfiadEiajD9N1CTWDTw5dFicwzIv7ib76MQUY2hJnFJIpW7zwYunE2Ae36qg/640?wx_fmt=png" data-type="png" data-w="1166" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfiadEiajD9N1CTWDTw5dFicwzIv7ib76MQUY2hJnFJIpW7zwYunE2Ae36qg/640?wx_fmt=png"></figure><p>或者，我们稍微调整下参数，就可以得到同心圆图了：</p><pre><code>p &lt;- ggplot(diamond)+geom_bar(aes(x=cut, fill=cut))<br><span># x和y轴翻转</span><br>p1 &lt;- p + coord_polar(theta=<span>"y"</span>)<br>p+p1<br></code></pre><figure><img data-ratio="0.3763352506162695" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfSw9UBSIKeAx9CsfkFoX2sV0Hjg7IONnVnaE0xYDrfWuuBcicAaFPnzQ/640?wx_fmt=png" data-type="png" data-w="1217" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfSw9UBSIKeAx9CsfkFoX2sV0Hjg7IONnVnaE0xYDrfWuuBcicAaFPnzQ/640?wx_fmt=png"></figure><p>如果我们只看一个数据，就可以得到饼图：</p><pre><code>p &lt;- ggplot(diamond)+geom_bar(aes(x=<span>1</span>, fill=cut))<br><span># x和y轴翻转</span><br>p1 &lt;- p + coord_polar(theta=<span>"y"</span>)<br>p+p1<br></code></pre><figure><img data-ratio="0.3590163934426229" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfmNjOgwDuRjiaLtWnJdh7MldgYibemC6lZLGyfmU7ibsSwwE8VQMKgDxEQ/640?wx_fmt=png" data-type="png" data-w="1220" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfmNjOgwDuRjiaLtWnJdh7MldgYibemC6lZLGyfmU7ibsSwwE8VQMKgDxEQ/640?wx_fmt=png"></figure><h3><span>7. 分面（Facet）</span></h3><p>这部分比较简单，用一张图概括知识点：</p><figure><img data-ratio="0.5338461538461539" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfK0TibWhcyjr6Jro3FHGIL3QXktGCOGgiabGibCIm341w3Y1ZgvtcA4bcQ/640?wx_fmt=png" data-type="png" data-w="650" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfK0TibWhcyjr6Jro3FHGIL3QXktGCOGgiabGibCIm341w3Y1ZgvtcA4bcQ/640?wx_fmt=png"></figure><ul><li><p><code>facet_wrap</code>：基于一个因子进行设置，可以自由设置具体分为几行（<code>nrow</code>）几列（<code>ncol</code>）</p></li><li><p><code>facet_grid</code>：基于两个因子进行设置，形式为：变量~变量（行~列）。<strong>如果把一个因子用点表示，也可以达到facet_wrap的效果</strong>，也可以用加号设置成两个以上变量</p></li></ul><p>一些常用的参数：</p><ul><li><p><code>scales</code>：<code>fixed</code> 表示固定坐标轴刻度，<code>free</code> 表示反馈坐标轴刻度，也可以单独设置成 <code>free_x</code> 或 <code>free_y</code></p></li><li><p><code>nrow</code>：分成几行</p></li><li><p><code>ncol</code>：分成几列</p></li></ul><p>然后我们简单实践下：</p><pre><code>p &lt;- ggplot(mpg, aes(cty, hwy)) + geom_point()<br>p1 &lt;- p + facet_grid(. ~ fl)<br>p2 &lt;- p + facet_grid(year ~ .)<br>p3 &lt;- p + facet_grid(year ~ fl)<br>p4 &lt;- p + facet_wrap(~ fl)<br>p1+p2+p3+p4<br></code></pre><figure><img data-ratio="0.4420866489832007" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryf6zjDdkVCKEHjeeL53EWWjxXsXicGuibsyiaCMBFvLXZrtnMHUh0RcR4jA/640?wx_fmt=png" data-type="png" data-w="1131" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryf6zjDdkVCKEHjeeL53EWWjxXsXicGuibsyiaCMBFvLXZrtnMHUh0RcR4jA/640?wx_fmt=png"></figure><h3><span>8. 主题（Theme）</span></h3><p>ggplot画图之后，需要根据需求对图进行进一步的美化，我们可以通过ggplot的主题进行修改图形的细节。</p><p>主题涉及到2个部分：</p><ul><li><p>theme 参数修改：参考<a href="https://mp.weixin.qq.com/s?__biz=MzIyNDI1MzgzOQ==&amp;mid=2650394226&amp;idx=1&amp;sn=79f62bb8467f887c99c0a6a63051a0c0&amp;scene=21#wechat_redirect" data-linktype="2">ggplot2|theme主题设置，详解绘图优化-“精雕细琢”</a></p></li><li><p><span>ggplot2 相关主题：</span></p></li><li><p><span>默认主题</span></p></li><li><p>扩展包主题：参考<a href="https://mp.weixin.qq.com/s?__biz=Mzg3NjcxNzA1OQ==&amp;mid=2247485002&amp;idx=1&amp;sn=5990db92f3f87673d3bb37a1fba70f01&amp;scene=21#wechat_redirect" data-linktype="2">R语言绘图|ggplot2绘图过程中主题(theme)使用</a></p></li></ul><h4><span>8.1 theme 参数</span></h4><p>我们先画一个原始的图：</p><pre><code><span># 绘制初始图形</span><br>p &lt;- ggplot(data = diamond) +<br>  geom_point(aes(x=carat, y=price, colour=color,shape=cut)) + <br>  labs(title=<span>"学习ggplot2可视化"</span>,subtitle = <span>"参数好多学不会？"</span>,caption = <span>"熟能生巧"</span>)<br>p<br></code></pre><figure><img data-ratio="0.863849765258216" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfS6K37S21857AlFZvZNUXe2uPKelvAZLF1ibWBvquk93tjzMcG4e7qwg/640?wx_fmt=png" data-type="png" data-w="852" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfS6K37S21857AlFZvZNUXe2uPKelvAZLF1ibWBvquk93tjzMcG4e7qwg/640?wx_fmt=png"></figure><p>然后我们可以对 <code>theme()</code> 函数进行探索。</p><p><code>theme()</code> 有大量参数，可以实现更改图形外观的大多数要求，有四种主要类型：</p><ol><li><p><code>element_text()</code>：使用 <code>element_text()</code> 函数设置<strong>基于文本的组件</strong>，如title,subtitle 和caption等。</p></li><li><p><code>element_line()</code>：使用 <code>element_line()</code> 设置<strong>基于线的组件</strong>，如轴线，主网格线和次网格线等。</p></li><li><p><code>element_rect()</code>：使用 <code>element_rect()</code> 修改<strong>基于矩形的组件</strong>，如绘图区域和面板区域的背景。</p></li><li><p><code>element_blank()</code>：使用 <code>element_blank()</code> <strong>关闭显示的主题内容</strong>。</p></li></ol><h5><span>8.1.1 修改标题，坐标轴</span></h5><p>由于绘图和轴标题是文本组件，使用 <code>element_text()</code> 参数修改。</p><ol><li><p><span>设置title的尺寸，颜色，线高，位置</span></p></li></ol><pre><code>p1 &lt;- p + theme(plot.title=element_text(size=<span>20</span>,<br>                                        face=<span>"bold"</span>,<br>                                        color=<span>"skyblue"</span>, <span>#颜色</span><br>                                        hjust=<span>0.5</span>, <span>#调整位置，正中间</span><br>                                        lineheight=<span>1.2</span>))<br>p + p1<br></code></pre><figure><img data-ratio="0.5197628458498024" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfTg4ZSlELlmrHned3Ngu8SGSiaoOgUJ2iaHfanXGb1LgC28gfYj10ebTQ/640?wx_fmt=png" data-type="png" data-w="1012" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfTg4ZSlELlmrHned3Ngu8SGSiaoOgUJ2iaHfanXGb1LgC28gfYj10ebTQ/640?wx_fmt=png"></figure><ol start="2"><li><p><span>设置subtitle和caption</span></p></li></ol><pre><code>p1 &lt;- p + theme(plot.subtitle=element_text(size=<span>15</span>,<br>                                           face=<span>"bold"</span>,<br>                                           color = <span>"red"</span>,<br>                                           hjust=<span>0.5</span>),  <span># subtitle</span><br>                plot.caption=element_text(size=<span>15</span>))  <span># caption</span><br>p + p1<br></code></pre><figure><img data-ratio="0.46863468634686345" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfX9v44uic98TtWTIR8Bbp3808lYPZtoiczyc5POp4zMPSsqGpETc4BjSQ/640?wx_fmt=png" data-type="png" data-w="1355" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfX9v44uic98TtWTIR8Bbp3808lYPZtoiczyc5POp4zMPSsqGpETc4BjSQ/640?wx_fmt=png"></figure><ol start="3"><li><p><span>修改坐标轴</span></p></li></ol><pre><code>p1 &lt;- p + theme(axis.title.x=element_text(vjust=<span>1</span>,  <br>                                          size=<span>20</span>),  <span># X axis title</span><br>                axis.title.y=element_text(size=<span>10</span>,<br>                                          color = <span>"blue"</span>),  <span># Y axis title</span><br>                axis.text.x=element_text(size=<span>10</span>,<br>                                         angle = <span>45</span>,<br>                                         color = <span>"red"</span>,<br>                                         vjust=<span>.5</span>),  <span># X axis text</span><br>                axis.text.y=element_text(size=<span>10</span>))  <span># Y axis text</span><br>p + p1<br></code></pre><figure><img data-ratio="0.4429327286470144" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryflZibebdmib4NmeesNaUibSbdPmUxcV4fyYBUhVhBKnYibZH0JIX2t6yCfA/640?wx_fmt=png" data-type="png" data-w="1323" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryflZibebdmib4NmeesNaUibSbdPmUxcV4fyYBUhVhBKnYibZH0JIX2t6yCfA/640?wx_fmt=png"></figure><p>以上示例涵盖了一些常用的主题修改，其中</p><ul><li><p><code>vjust</code>，控制标题（或标签）和绘图之间的<strong>垂直间距</strong>。</p></li><li><p><code>hjust</code>，控制<strong>水平间距</strong>。将其设置为 0.5 将标题<strong>居中</strong>。</p></li><li><p><code>face</code>，设置字体（“<code>plain</code>”，“<code>italic</code>”，“<code>bold</code>”，“<code>bold.italic</code>”）</p></li></ul><h5><span>8.1.2 修改图例</span></h5><p>图例的关键是像元素一样的图形，因此使用 <code>element_rect()</code> 函数进行设置。</p><ol><li><p><span>设置图例标题，文本和键的样式:</span></p></li></ol><pre><code>p + theme(legend.title = element_text(size=<span>15</span>, color = <span>"firebrick"</span>),<br>          legend.text = element_text(size=<span>10</span>),<br>          legend.key=element_rect(fill=<span>'green'</span>))<br></code></pre><figure><img data-ratio="0.426056338028169" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfvialgNoG7Rx6ibkHKiajhU0RJxQcUXc8jEtJ09dN5PVpC5KxsPElvqxew/640?wx_fmt=png" data-type="png" data-w="1420" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfvialgNoG7Rx6ibkHKiajhU0RJxQcUXc8jEtJ09dN5PVpC5KxsPElvqxew/640?wx_fmt=png"></figure><ol start="2"><li><p><span>删除图例和更改图例位置：</span></p></li></ol><pre><code>p1 &lt;- p + theme(legend.position=<span>"None"</span>) + labs(subtitle=<span>"No Legend"</span>)<br><br>p2 &lt;- p + theme(legend.position=<span>"bottom"</span>, legend.box = <span>"horizontal"</span>) + labs(subtitle=<span>"Legend bottom"</span>)<br><br>p3 &lt;- p + theme(legend.title = element_text(size=<span>12</span>, color = <span>"salmon"</span>, face=<span>"bold"</span>),<br>          legend.justification=c(<span>1</span>,<span>0</span>),<br>          legend.position=c(<span>0.95</span>, <span>0.05</span>),  <br>          legend.background = element_blank(),<br>          legend.key = element_blank()) +<br>  labs(subtitle=<span>"Legend: Bottom-Right Inside the Plot"</span>)<br><br>p / p1 / p2 / p3<br></code></pre><figure><img data-ratio="1.5973154362416107" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfM74Zibzx9nbXCymLlVgJiaibGdWfdx2YmjmtC8wMJicBGBaZFBqm2nQ7iaA/640?wx_fmt=png" data-type="png" data-w="2980" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfM74Zibzx9nbXCymLlVgJiaibGdWfdx2YmjmtC8wMJicBGBaZFBqm2nQ7iaA/640?wx_fmt=png"><figcaption>legend</figcaption></figure><h5><span>8.1.3 修改绘图背景，主轴和次轴</span></h5><ol><li><p><span>更改绘图背景</span></p></li></ol><pre><code>p1 &lt;- p + theme(panel.background = element_rect(fill = <span>'grey80'</span>),<br>                plot.background=element_rect(fill=<span>"khaki"</span>),<br>                plot.margin = unit(c(<span>3</span>, <span>2</span>, <span>1</span>, <span>1</span>), <span>"cm"</span>)) +  <span>#设置绘图区域距离边的据类，上，右，下，左</span><br>  labs(title=<span>"Modified Background"</span>, subtitle=<span>"Change Plot Margin"</span>)<br><br>p + p1<br></code></pre><figure><img data-ratio="0.44540853217642806" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfp0wiciaHV2ibryY2elkq2sD3arhicev3zicIP5kFAtgOgFsVWuHibDcYdroQ/640?wx_fmt=png" data-type="png" data-w="1383" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfp0wiciaHV2ibryY2elkq2sD3arhicev3zicIP5kFAtgOgFsVWuHibDcYdroQ/640?wx_fmt=png"></figure><ol start="2"><li><p><span>更改主次网格线以及X,Y坐标轴</span></p></li></ol><pre><code>p1 &lt;- p + theme(<br>  panel.grid.major = element_line(colour = <span>"burlywood"</span>, size=<span>1.5</span>),<br>  panel.grid.minor = element_line(colour = <span>"tomato"</span>,<br>                                  size=<span>0.25</span>,<br>                                  linetype = <span>"dashed"</span>),<br>  axis.line.x = element_line(colour = <span>"darkorange"</span>,<br>                             size=<span>1.5</span>,<br>                             lineend = <span>"butt"</span>),<br>  axis.line.y = element_line(colour = <span>"skyblue"</span>,<br>                             size=<span>1.5</span>)) +<br>  labs(subtitle=<span>"Change Major and Minor grid, Axis Lines"</span>)<br><br>p + p1<br></code></pre><figure><img data-ratio="0.4244868035190616" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfaJY1mgMO4hsz32TUShN0GzjZWk81jOkWw1ClkGfiaTI8eOibm7VYcMPg/640?wx_fmt=png" data-type="png" data-w="1364" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfaJY1mgMO4hsz32TUShN0GzjZWk81jOkWw1ClkGfiaTI8eOibm7VYcMPg/640?wx_fmt=png"></figure><ol start="3"><li><p><span>删除主，次网格线，边框，轴标题，文本和刻度</span></p></li></ol><pre><code>p1 &lt;- p + theme(panel.grid.major = element_blank(), <span>#主网格线</span><br>                panel.grid.minor = element_blank(), <span>#次网格线</span><br>                axis.title = element_blank(),  <span>#轴标题</span><br>                axis.text = element_blank(), <span># 文本</span><br>                axis.ticks = element_blank()) + <span># 坐标轴上对应label的小虚线</span><br>  labs(title=<span>"Modified Background"</span>, subtitle=<span>"Remove major and minor axis grid, axis title, text and ticks"</span>)<br><br>p + p1<br></code></pre><figure><img data-ratio="0.44263565891472867" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfn8w4ulbSSNHJj7fr2Ohe6sVicbPYic7CBKqCeNrQZ53uOzzux4tfO5gQ/640?wx_fmt=png" data-type="png" data-w="1290" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfn8w4ulbSSNHJj7fr2Ohe6sVicbPYic7CBKqCeNrQZ53uOzzux4tfO5gQ/640?wx_fmt=png"></figure><h4><span>8.2 相关主题</span></h4><h5><span>8.2.1 ggplot2默认主题</span></h5><pre><code>p &lt;- ggplot(mtcars, aes(x = mpg, y = hp)) + <span>#制定数据，对数据进行映射</span><br>  geom_point() + <span>#散点图图层</span><br>  geom_smooth(method = lm) <span># 添加拟合曲线</span><br><br>p1 &lt;- p + labs(title=<span>"默认主题"</span>)<br>p2 &lt;- p + theme_bw() + labs(title=<span>"theme_bw"</span>)<br>p3 &lt;- p + theme_test() + labs(title=<span>"theme_test"</span>)<br>p4 &lt;- p + theme_classic() + labs(title=<span>"theme_classic"</span>)<br>p5 &lt;- p + theme_dark() + labs(title=<span>"theme_dark"</span>)<br>p6 &lt;- p + theme_gray() + labs(title=<span>"theme_gray"</span>)<br>p7 &lt;- p + theme_light() + labs(title=<span>"theme_light"</span>)<br>p8 &lt;- p + theme_linedraw() + labs(title=<span>"theme_linedraw"</span>)<br>p9 &lt;- p + theme_minimal() + labs(title=<span>"theme_minimal"</span>)<br>p10 &lt;- p + theme_void() + labs(title=<span>"theme_void"</span>)<br><br>(p1+p2) / (p3+p4) / (p5+p6) / (p7+p8) / (p9+p10)<br></code></pre><figure><img data-ratio="1.8836424957841484" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryflVBPjPLicRZmjLmhQbqJaIDOokY4WxWAJF3awn19Pyg6b5mWOwn7SpA/640?wx_fmt=png" data-type="png" data-w="2372" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryflVBPjPLicRZmjLmhQbqJaIDOokY4WxWAJF3awn19Pyg6b5mWOwn7SpA/640?wx_fmt=png"><figcaption>ggplot2_theme</figcaption></figure><h5><span>8.2.2 扩展包主题</span></h5><ol><li><p><code>ggthemes</code> 包的主题：</p></li></ol><pre><code><span>library</span>(ggthemes)<br>p &lt;- ggplot(mtcars, aes(x = mpg, y = hp)) + <span>#制定数据，对数据进行映射</span><br>  geom_point() + <span>#散点图图层</span><br>  geom_smooth(method = lm) <span># 添加拟合曲线</span><br><br>p1 &lt;- p + theme_base() + labs(title=<span>"theme_base"</span>)<br>p2 &lt;- p + theme_calc() + labs(title=<span>"theme_calc"</span>)<br>p3 &lt;- p + theme_clean() + labs(title=<span>"theme_clean"</span>)<br>p4 &lt;- p + theme_economist() + labs(title=<span>"theme_economist"</span>)<br>p5 &lt;- p + theme_economist_white() + labs(title=<span>"theme_economist_white"</span>)<br>p6 &lt;- p + theme_excel() + labs(title=<span>"theme_excel"</span>)<br>p7 &lt;- p + theme_excel_new() + labs(title=<span>"theme_excel_new"</span>)<br>p8 &lt;- p + theme_few() + labs(title=<span>"theme_few"</span>)<br>p9 &lt;- p + theme_fivethirtyeight() + labs(title=<span>"theme_fivethirtyeight"</span>)<br>p10 &lt;- p + theme_foundation() + labs(title=<span>"theme_foundation"</span>)<br>p11 &lt;- p + theme_gdocs() + labs(title=<span>"theme_gdocs"</span>)<br>p12 &lt;- p + theme_hc() + labs(title=<span>"theme_hc"</span>)<br>p13 &lt;- p + theme_igray() + labs(title=<span>"theme_igray"</span>)<br>p14 &lt;- p + theme_map() + labs(title=<span>"theme_map"</span>)<br>p15 &lt;- p + theme_pander() + labs(title=<span>"theme_pander"</span>)<br>p16 &lt;- p + theme_par() + labs(title=<span>"theme_par"</span>)<br>p17 &lt;- p + theme_solarized() + labs(title=<span>"theme_solarized"</span>)<br>p18 &lt;- p + theme_solarized_2() + labs(title=<span>"theme_solarized_2"</span>)<br>p19 &lt;- p + theme_solid() + labs(title=<span>"theme_solid"</span>)<br>p20 &lt;- p + theme_stata() + labs(title=<span>"theme_stata"</span>)<br>p21 &lt;- p + theme_tufte() + labs(title=<span>"theme_tufte"</span>)<br>p22 &lt;- p + theme_wsj() + labs(title=<span>"theme_wsj"</span>)<br><br>(p1+p2) / (p3+p4) / (p5+p6) / (p7+p8) / (p9+p10) / (p11+p12) / (p13+p14) / (p15+p16) / (p17+p18) / (p19+p20) / (p21+p22)<br></code></pre><figure><img data-ratio="3.1442953020134228" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryf4FFM8ICp81f4jWUfoKzlLfQJePPv7Z3wMGNyZgyzcg3Mpp9bsibG4zw/640?wx_fmt=png" data-type="png" data-w="2384" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryf4FFM8ICp81f4jWUfoKzlLfQJePPv7Z3wMGNyZgyzcg3Mpp9bsibG4zw/640?wx_fmt=png"><figcaption>ggthemes_theme</figcaption></figure><ol start="2"><li><p><code>cowplot</code> 包的主题：</p></li></ol><pre><code>p1 &lt;- p + theme_cowplot() + labs(title=<span>"theme_cowplot"</span>)<br>p2 &lt;- p + theme_minimal_grid() + labs(title=<span>"theme_minimal_grid"</span>)<br>p3 &lt;- p + theme_minimal_hgrid() + labs(title=<span>"theme_minimal_hgrid"</span>)<br>p4 &lt;- p + theme_nothing() + labs(title=<span>"theme_nothing"</span>)<br><br>(p1+p2) / (p3+p4)<br></code></pre><figure><img data-ratio="0.8546712802768166" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfCXcqbCz99JA35cWQV3p1ahcQnnd0Kebdy6kXNqOooQL5edZLnDSV3A/640?wx_fmt=png" data-type="png" data-w="867" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfCXcqbCz99JA35cWQV3p1ahcQnnd0Kebdy6kXNqOooQL5edZLnDSV3A/640?wx_fmt=png"><figcaption>cowplot_theme</figcaption></figure><h3><span>9. 其他小知识</span></h3><h4><span>9.1 多张图合并</span></h4><p>方法1：画布分割</p><pre><code><span># 画布分割为1行2列</span><br>split.screen(c(<span>1</span>, <span>2</span>))<br><span># 第1个位置画图</span><br>screen(<span>1</span>)<br>plot(diamond$carat, diamond$price)<br><span># 第2个位置画图</span><br>screen(<span>2</span>)<br>plot(diamond$carat, diamond$table)<br><span># 结束绘图</span><br>dev.off()<br></code></pre><figure><img data-ratio="0.48823529411764705" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfpZqsukGm4RSnk0BXghO07Xymmsq30AibLDtyvFOPBoCbuoqYmk51ib6A/640?wx_fmt=png" data-type="png" data-w="1360" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfpZqsukGm4RSnk0BXghO07Xymmsq30AibLDtyvFOPBoCbuoqYmk51ib6A/640?wx_fmt=png"></figure><p>方法2：patchwork包</p><pre><code><span>library</span>(patchwork)<br>p1 &lt;- ggplot(data = diamond)+geom_point(aes(x=carat, y=price, colour=color))<br>p2 &lt;- ggplot(data = diamond) +geom_point(aes(x=carat, y=price, shape=cut))<br>p1+p2<br></code></pre><figure><img data-ratio="0.5474613686534217" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfzQmyPhvYD3651gZicsUDibA1dG9icdDpFsHGv9aarflw1F3cIQEZry0VQ/640?wx_fmt=png" data-type="png" data-w="1359" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfzQmyPhvYD3651gZicsUDibA1dG9icdDpFsHGv9aarflw1F3cIQEZry0VQ/640?wx_fmt=png"></figure><p>方法3：ggpubr包</p><pre><code><span>library</span>(ggpubr)<br>p1 &lt;- ggplot(data = diamond)+geom_point(aes(x=carat, y=price, colour=color))<br>p2 &lt;- ggplot(data = diamond) +geom_point(aes(x=carat, y=price, shape=cut))<br>ggarrange(p1, p2, ncol = <span>2</span>, nrow = <span>1</span>) <br></code></pre><figure><img data-ratio="0.5474613686534217" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfzQmyPhvYD3651gZicsUDibA1dG9icdDpFsHGv9aarflw1F3cIQEZry0VQ/640?wx_fmt=png" data-type="png" data-w="1359" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJp1JQmtsPKLUr4JXjmwNryfzQmyPhvYD3651gZicsUDibA1dG9icdDpFsHGv9aarflw1F3cIQEZry0VQ/640?wx_fmt=png"></figure><figure><figcaption><br></figcaption></figure><h4><span>9.2 额外添加直线</span></h4><pre><code>geom_abline(slope, intercept)<br>geom_hline(yintercept)<br>geom_vline(xintercept)<br><span># 其他设置</span><br>    <span># 颜色：</span><br>colour = <span>"red"</span><br>    <span># 粗细</span><br>size = <span>1</span><br></code></pre><ul><li><p><code>geom_abline</code>：添加斜线，参数 <code>slope</code> 表示斜率，<code>intercept</code> 表示截距</p></li><li><p><code>geom_hline</code>：添加水平线，参数 <code>yintercept</code> 表示y轴截距或直线所在位置</p></li><li><p><code>geom_vline</code>：添加垂直线，参数 <code>xintercept</code> 表示x轴截距或直线所在位置</p></li></ul><h5><span>9.2.1 设置为虚线</span></h5><pre><code>geom_abline(linetype=<span>"dashed"</span>)<br></code></pre><h4><span>9.3 坐标轴中间设置中断</span></h4><pre><code><span>library</span>(ggbreak)<br>ggplot(dat)+<br>  geom_bar(aes(x=x,y=y),stat=<span>"identity"</span>)+<br>  scale_y_break(c(<span>1</span>, <span>4</span>))<br></code></pre><h4><span>9.4 改变字体大小</span></h4><h5><span>9.4.1 倍数改变</span></h5><pre><code><span># 主要依赖于rel()函数完成大小倍数的调整</span><br>theme(axis.text   = element_text(size = rel(<span>0.8</span>)), <span># 字体大小</span><br>      strip.text  = element_text(size = rel(<span>0.8</span>)),<span># 刻面标题</span><br>      legend.text = element_text(size = rel(<span>0.8</span>)),<span># legend字体</span><br>      plot.title  = element_text(size = rel(<span>1.2</span>)),<span># title字体</span><br>      panel.grid.minor = element_line(size = rel(<span>0.5</span>)),<span># 线段大小</span><br>      axis.text.x = element_text(size = rel(<span>1.2</span>)),<span># x轴刻度标签文本</span><br>      axis.text.y = element_text(size = rel(<span>1.2</span>)),<span># y轴刻度标签文本</span><br>      axis.title.x = element_text(size = rel(<span>1.2</span>)),<span># x轴刻度标题文本</span><br>      axis.title.y = element_text(size = rel(<span>1.2</span>)))<span># y轴刻度标题文本</span><br></code></pre><h5><span>9.4.2 指定具体大小</span></h5><pre><code><span># 直接指定文字大小</span><br>theme(axis.text   = element_text(size = <span>5.5</span>), <span># 字体大小</span><br>      strip.text  = element_text(size = <span>5.5</span>),<span># 刻面标题</span><br>      legend.text = element_text(size = <span>5.5</span>),<span># legend字体</span><br>      plot.title  = element_text(size = <span>5</span>),<span># title字体</span><br>      panel.grid.minor = element_line(size = <span>2</span>),<span># 线段大小</span><br>      axis.text.x = element_text(size = <span>5</span>),<span># x轴刻度标签文本</span><br>      axis.text.y = element_text(size = <span>5</span>),<span># y轴刻度标签文本</span><br>      axis.title.x = element_text(size = <span>5</span>),<span># x轴刻度标题文本</span><br>      axis.title.y = element_text(size = <span>5</span>))<span># y轴刻度标题文本</span><br></code></pre><h4><span>9.5 坐标轴上label旋转</span></h4><pre><code><span># x轴刻度标签文本旋转45度，hjust用于设置水平对齐方式（1顶部，0.5中间，0底部），vjust用于设置垂直对齐方式（0左，0.5中，1右）。</span><br>theme(axis.text.x = element_text(angle = <span>45</span>, hjust = <span>1</span>, vjust = <span>1</span>),<br>      axis.text.y = element_text(angle = <span>45</span>, hjust = <span>1</span>, vjust = <span>1</span>))<br></code></pre><h4><span>9.6 图片上特定地方添加字母label</span></h4><pre><code><span># 使用R包</span><br><span>library</span>(ggrepel)<br>ggplot(dat,aes(x=x,y=y))+<br>  geom_bar(stat=<span>"identity"</span>)+<br>  geom_label_repel(label=dat$labels)<br><br><span># 使用ggplot2自带函数</span><br>ggplot(dat,aes(x=x,y=y))+<br>  geom_bar(stat=<span>"identity"</span>)+<br>  geom_text(label=dat$labels,nudge_x=-<span>0.2</span>,size=<span>5</span>)<br></code></pre><h3><span>后记</span></h3><p>后续再做补充~</p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/odVkcX5lnz1MOmz8MQf-4A",target="_blank" rel="noopener noreferrer">原文链接</a>
