---
title: "GSEA富集到的通路相关信息有没有？"
date: 2023-11-23T09:25:13Z
draft: ["false"]
tags: [
  "fetched",
  "YuLabSMU"
]
categories: ["Duty"]
---
GSEA富集到的通路相关信息有没有？ by YuLabSMU
------
<div><p data-mpa-powered-by="yiban.io">上一次《<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247492265&amp;idx=1&amp;sn=2ee78c1179402a2bdc88d836c20db735&amp;chksm=ec4053eedb37daf8e0acdc60cb15a42266e2517d571b01b9cd16ede03a577608e98b9a32a8c3&amp;scene=21#wechat_redirect" textvalue="你想在GSEA可视化图中标注几个基因？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">你想在GSEA可视化图中标注几个基因？</a>》问的其实也是这个问题，虽然针对标注基因，给了解决方案，但实际的数值信息你还是没拿到。</p><p>对于感兴趣的通路，像running ES这些信息，其实我们有另一个图，是gsearank()函数画出来的，正好就是画这个信息，我们在《<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247492125&amp;idx=1&amp;sn=894f7ffcbd9de1944778415082378b07&amp;chksm=ec40535adb37da4cfdbf524f03f43cb52ca1516db42003ebc28bca8137be8d13a9a0763d87f7&amp;scene=21#wechat_redirect" textvalue="文章发表：基于癌症干性识别索拉非尼的耐药机制" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">文章发表：基于癌症干性识别索拉非尼的耐药机制</a>》一文中就用到了这种图。<br></p><p>我们先来个例子：</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><pre data-tool="mdnice编辑器"><span></span><code>require(clusterProfiler)<br>data(geneList, package=<span>"DOSE"</span>)<br><br>x &lt;- gseKEGG(geneList)<br><br>require(enrichplot)<br>id &lt;- <span>'hsa04110'</span> <br>gsearank(x, id)<span></span></code></pre></section><p><img data-croporisrc="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4k781sFuJ7PF8zEqGYiccXwvgicMOj07D0UloOHyUmUrZQ7Y198DqLCFfUEflf1v28gTz7yrgVSnticw/0?wx_fmt=png" data-cropx1="8.114186851211073" data-cropx2="670" data-cropy1="0" data-cropy2="357.02422145328717" data-galleryid="" data-ratio="0.5392749244712991" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MPBFtnFrw4k781sFuJ7PF8zEqGYiccXwvAyJS25axHcQP1Ts0OnHhO2EmvKj1hlk0IaGMia870nP1s8SXFmd4xwQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="662" src="https://mmbiz.qpic.cn/mmbiz_jpg/MPBFtnFrw4k781sFuJ7PF8zEqGYiccXwvAyJS25axHcQP1Ts0OnHhO2EmvKj1hlk0IaGMia870nP1s8SXFmd4xwQ/640?wx_fmt=jpeg"></p><p><br></p><p>能不能把这个图的信息，给到大家呢？答案当然是可以，于是我又更了一下这个函数，引入一个参数output = "plot"，行为和原来一样画一个图，然后你可以传output = "table"，那么返回来就是一个表格，相应通路的信息就有了。<br></p><p><br></p><p><img data-galleryid="" data-ratio="0.4485294117647059" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4k781sFuJ7PF8zEqGYiccXwvzDkdGnlVFR3WibJpXWcJiaLalRDt6icP7Tw3bAopV3qUicKhK1v4Xjypgg/640?wx_fmt=png" data-type="png" data-w="544" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4k781sFuJ7PF8zEqGYiccXwvzDkdGnlVFR3WibJpXWcJiaLalRDt6icP7Tw3bAopV3qUicKhK1v4Xjypgg/640?wx_fmt=png"></p><p><br></p><p>这个是基于基因的，基因在什么位置，对通路富集的贡献，是不是leading edge里的基因。不过瘾是吧？因为你想知道基因的信息，这样的表格，才方便你在里面看有没有感兴趣的基因。加点信息太容易，比如说用bitr函数来点料。</p><p><img data-galleryid="" data-ratio="0.5200764818355641" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4k781sFuJ7PF8zEqGYiccXwvphGccCZTojtUTf0fsqjD3yViaMQzohncUsEmHWBHfDmC9uZWebajA0g/640?wx_fmt=png" data-type="png" data-w="523" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4k781sFuJ7PF8zEqGYiccXwvphGccCZTojtUTf0fsqjD3yViaMQzohncUsEmHWBHfDmC9uZWebajA0g/640?wx_fmt=png"></p><p><br></p><p>然后无非是merge一下，当然你用merge的话，排序会乱，你可以自己重新排一下。像下面这样子，通路里的基因信息就有了。</p><p><img data-galleryid="" data-ratio="0.643598615916955" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4k781sFuJ7PF8zEqGYiccXwvcOM9gSWFYUjbJdFsLLE5p7HfwRnpjgbWFoe8E55nlwGRpm2ZLGzVVQ/640?wx_fmt=png" data-type="png" data-w="" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4k781sFuJ7PF8zEqGYiccXwvcOM9gSWFYUjbJdFsLLE5p7HfwRnpjgbWFoe8E55nlwGRpm2ZLGzVVQ/640?wx_fmt=png"></p><p><br></p><p>你可以对column进行排列，把基因symbol，name什么的，放到前面去。</p><p><img data-galleryid="" data-ratio="0.9702300405953992" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4k781sFuJ7PF8zEqGYiccXwvHltEL01SsKIjrqhvcnqs4wUKapsOKUV2AB088j9iczImUyaAB94aibHA/640?wx_fmt=png" data-type="png" data-w="739" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4k781sFuJ7PF8zEqGYiccXwvHltEL01SsKIjrqhvcnqs4wUKapsOKUV2AB088j9iczImUyaAB94aibHA/640?wx_fmt=png"></p><p><br></p><p>这个表格是通路里所有的基因，包括leading edge (core enrichment)和非leading edge里的。全都在里面。<br></p><p>PS: 上一篇文章《<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247492265&amp;idx=1&amp;sn=2ee78c1179402a2bdc88d836c20db735&amp;chksm=ec4053eedb37daf8e0acdc60cb15a42266e2517d571b01b9cd16ede03a577608e98b9a32a8c3&amp;scene=21#wechat_redirect" textvalue="你想在GSEA可视化图中标注几个基因？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">你想在GSEA可视化图中标注几个基因？</a>》里面提到的geom_gsea_gene图层，也可以直接加在这个gsearank()出的图上哦。这就是图层设计的好处，比在函数里写死，好太多。这个具有灵活性和通用性。当然我现在当前就是一个通用的设计，把标注打上去，至于怎么打？用户说了算，用户自己去调参数，如果你有好的例子，有一些参数调整的行为能够更好地出图，也欢迎反馈给我，我可以相应的看一看是否整合进去，搞点默认行为，让函数一键出图时，就已然是没啥好调整的，那是最理想的。<br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/SyAjUIZUWqFSzO0xLY9PjA",target="_blank" rel="noopener noreferrer">原文链接</a>
