---
title: "显示你的论文引用地图"
date: 2023-02-19T01:41:20Z
draft: ["false"]
tags: [
  "fetched",
  "方圆之处"
]
categories: ["Duty"]
---
显示你的论文引用地图 by 方圆之处
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">在Web of Science里，你可以生成一个漂亮的论文引用地图。在这篇文章中，我将展示如何从Web of Science中下载引用数据和如何在R中绘制论文引用地图。</p><p data-tool="mdnice编辑器">在Web of Science中，引用数据的链接并不好找。但是因为引用地图是展示在网页上的，那么其实引用数据会被浏览器下载到本地。因此现在的问题是如何找到引用数据。</p><p data-tool="mdnice编辑器">在下文中，我只以Chrome浏览器为例。</p><p data-tool="mdnice编辑器"><strong>第一步</strong>：登录到你的个人Web of Science上。</p><p data-tool="mdnice编辑器"><strong>第二步</strong>：在Chrome中打开Developer Tools，有两种方法可以打开：</p><ol data-tool="mdnice编辑器"><li><section>在网页上右击鼠标，然后选择"Inspect"。</section></li><li><section>在Chrome的菜单栏，View -&gt; Developer -&gt; Developer’s Tools。</section></li></ol><p data-tool="mdnice编辑器"><strong>第三步</strong>：在你的个人Web of Science中，点击“My research profile”.</p><figure data-tool="mdnice编辑器"><img data-ratio="0.6817288801571709" data-src="https://mmbiz.qpic.cn/mmbiz_png/8yoFdJolUibcG56rEOU2yqMIvuhdlPVmfVoXic1IPZpwwNlcF5eC9E6vF6RQib97noVv2VGPXfvuiahFnn9KkFfvdA/640?wx_fmt=png" data-type="png" data-w="2036" src="https://mmbiz.qpic.cn/mmbiz_png/8yoFdJolUibcG56rEOU2yqMIvuhdlPVmfVoXic1IPZpwwNlcF5eC9E6vF6RQib97noVv2VGPXfvuiahFnn9KkFfvdA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><strong>第四步</strong>：在这个页面中，点击“Open dashboard”。</p><p data-tool="mdnice编辑器"><strong>第五步</strong>：向下滚动网页，直至“Geographic Citation Map”，现在这里是模糊的，点击“Click to show map”。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.7509765625" data-src="https://mmbiz.qpic.cn/mmbiz_png/8yoFdJolUibcG56rEOU2yqMIvuhdlPVmfH7s6tCEYoMzecykt6fTBwBE3HvibFkyJyjtuVDdz6ibepwCllzB9gQEw/640?wx_fmt=png" data-type="png" data-w="2048" src="https://mmbiz.qpic.cn/mmbiz_png/8yoFdJolUibcG56rEOU2yqMIvuhdlPVmfH7s6tCEYoMzecykt6fTBwBE3HvibFkyJyjtuVDdz6ibepwCllzB9gQEw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><strong>第六步</strong>：在Developer Tool中，点击“Netowrk”标签（在最上面一行）。你可能会看到有很多的文件正在下载。当所有文件下载完毕，双击<code>natigation_poin.svg</code>上的那一个文件（路径名为<code>?task_id=...</code>，往往是文件大小最大的那一个）。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.48704954954954954" data-src="https://mmbiz.qpic.cn/mmbiz_png/8yoFdJolUibcG56rEOU2yqMIvuhdlPVmfRH5oZmVY3KJ0mzNXRAj9XhvJRicmjLrwQTCpI7SwXUt1tuhR6ERxL2Q/640?wx_fmt=png" data-type="png" data-w="3552" src="https://mmbiz.qpic.cn/mmbiz_png/8yoFdJolUibcG56rEOU2yqMIvuhdlPVmfRH5oZmVY3KJ0mzNXRAj9XhvJRicmjLrwQTCpI7SwXUt1tuhR6ERxL2Q/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">双击之后会打开一个网页，其中包含了一个json文件，这个json文件中包含了绘制引用地图的所有数据。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.4801343033016228" data-src="https://mmbiz.qpic.cn/mmbiz_png/8yoFdJolUibcG56rEOU2yqMIvuhdlPVmfEHvXUSLqvZm3sXZkEfVJyxdoLkcooyPc1Tl4FGN5bP6S3NBoGmsib9g/640?wx_fmt=png" data-type="png" data-w="3574" src="https://mmbiz.qpic.cn/mmbiz_png/8yoFdJolUibcG56rEOU2yqMIvuhdlPVmfEHvXUSLqvZm3sXZkEfVJyxdoLkcooyPc1Tl4FGN5bP6S3NBoGmsib9g/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><strong>第七步</strong>：将此json保存到文件中，例如通过“Ctrl + s”。我们假设这个文件为<code>citation.json</code>。可惜这个json文件并不能直接被<strong>jsonlite</strong>或者<strong>rjson</strong>包导入（肯能它并不是真正的json文件）。我们需要对此进行一个简单的修改。</p><p data-tool="mdnice编辑器"><code>citation.json</code>其实包含了合法的JavaScript命令。我们额外的将其赋予一个变量。在<code>citation.json</code>文件中，我们只需要简单的在开头加上<code>citation = </code>。我们假设这个变量名为<code>citation</code>。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5086013462976814" data-src="https://mmbiz.qpic.cn/mmbiz_png/8yoFdJolUibcG56rEOU2yqMIvuhdlPVmfsEY1VbLfzg4sf7Js1bib7FVSjiaKKWBCyDygAbPuxH3ic0e3A6ib5sPSZQ/640?wx_fmt=png" data-type="png" data-w="2674" src="https://mmbiz.qpic.cn/mmbiz_png/8yoFdJolUibcG56rEOU2yqMIvuhdlPVmfsEY1VbLfzg4sf7Js1bib7FVSjiaKKWBCyDygAbPuxH3ic0e3A6ib5sPSZQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><strong>第八步</strong>：现在我们可以通过使用<strong>V8</strong>包来执行<code>citation.json</code>中的JavaScript代码。</p><pre data-tool="mdnice编辑器"><code><span>library</span>(V8)<br>ct = v8()<br>ct$<span>source</span>(<span>"~/citation.json"</span>)<br><span>## [1] "[object Object]"</span><br></code></pre><p data-tool="mdnice编辑器"><strong>第九步</strong>：将JavaScript变量<code>citation</code>导入R中，这个以通过<code>ct</code>的<code>get()</code>方法进行。</p><pre data-tool="mdnice编辑器"><code>citation = ct$get(<span>"citation"</span>)<br></code></pre><p data-tool="mdnice编辑器">到现在为止，我们已经获取了引用数据，下面我们开始在R中对此数据进行处理。</p><p data-tool="mdnice编辑器">在这里我不会展示<code>citation</code>变量的全部内容，因为这个有一点复杂。<code>citation</code>是一个列表，这个我只取其<code>results</code>的元素。<code>results</code>元素是一个数据框。同时我只取<code>results</code>的前四列，因为第五列包含了引用论文的详细信息，例如作者，论文标题，我们下面的可视化不需要这些。</p><pre data-tool="mdnice编辑器"><code>results = citation$results[, <span>1</span>:<span>4</span>]<br>head(results)<br><span>##                     address publicationCount       lat       lon</span><br><span>## 1             Putian, China                2  25.35331 119.05826</span><br><span>## 2 Blacksburg, United States               10  37.22957 -80.41394</span><br><span>## 3   Richmond, United States                7  37.55376 -77.46026</span><br><span>## 4           Toronto, Canada              328  43.64455 -79.40712</span><br><span>## 5  New Haven, United States               75  41.30815 -72.92816</span><br><span>## 6         Sydney, Australia              135 -33.86785 151.20732</span><br></code></pre><p data-tool="mdnice编辑器">现在在变量<code>results</code>中，其中有地理位置坐标(<code>lat</code>和<code>lon</code>)。这两列可以绘制到地图上。</p><p data-tool="mdnice编辑器">下面的代码不是必须的。因为在同一个城市可能会有多所大学或者研究所，这只是将其汇集到一条记录里。如果你想区分不同的大学和研究所，你可以跳过下面这段代码，直接使用<code>results</code>.</p><pre data-tool="mdnice编辑器"><code>tb = data.frame(address = tapply(results$address, results$address, <span>function</span>(x) x[<span>1</span>]),<br>                publicationCount = tapply(results$publicationCount, results$address, sum),<br>                lat = tapply(results$lat, results$address, mean),<br>                lon = tapply(results$lon, results$address, mean))<br></code></pre><p data-tool="mdnice编辑器">最后我们绘制引用地图。这里我参考了网上的一个绘制地理地图的教程(https://r-spatial.org/r/2018/10/25/ggplot2-sf.html).</p><pre data-tool="mdnice编辑器"><code><span>library</span>(<span>"sf"</span>)<br><span>library</span>(<span>"rnaturalearth"</span>)<br><span>library</span>(<span>"rnaturalearthdata"</span>)<br>world = ne_countries(scale = <span>"medium"</span>, returnclass = <span>"sf"</span>)<br><br><span>library</span>(ggplot2)<br><span>library</span>(ggrepel)<br><span>library</span>(RColorBrewer)<br><br>ggplot(data = world) + geom_sf(color = <span>"grey"</span>, fill = <span>NA</span>) + <br>    geom_point(data = tb[order(tb$publicationCount), ], <br>        aes(x = lon, y = lat, color = publicationCount, size = publicationCount)) + <br>    scale_colour_gradientn(colours = rev(brewer.pal(<span>9</span>, <span>"Spectral"</span>))) +<br>    scale_size(range = c(<span>0.2</span>, <span>3</span>)) +<br>    geom_text_repel(data = tb[order(-tb$publicationCount)[<span>1</span>:<span>20</span>], ], <br>        mapping = aes(x = lon, y = lat, label = gsub(<span>", .*$"</span>, <span>""</span>, address)), <br>        box.padding = <span>0.5</span>, max.overlaps = <span>Inf</span>, min.segment.length = <span>0</span>, size = <span>3</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/8yoFdJolUibcG56rEOU2yqMIvuhdlPVmfNn05MJyVDEoXpOWsZTbyE4NLqoPO9VZiat9N3HJ6skfCxYHk8nPJGXw/640?wx_fmt=png" data-type="png" data-w="1920" src="https://mmbiz.qpic.cn/mmbiz_png/8yoFdJolUibcG56rEOU2yqMIvuhdlPVmfNn05MJyVDEoXpOWsZTbyE4NLqoPO9VZiat9N3HJ6skfCxYHk8nPJGXw/640?wx_fmt=png"></figure></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/dEcODSHn0UNAxvHERBM6bQ",target="_blank" rel="noopener noreferrer">原文链接</a>
